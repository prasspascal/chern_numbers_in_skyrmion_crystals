\documentclass[submission, Phys]{SciPost}

% Prevent all line breaks in inline equations.
\binoppenalty=10000
\relpenalty=10000

\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}

\usepackage[bitstream-charter]{mathdesign}
\urlstyle{sf}

\usepackage{wasysym}

% Fix \cal and \mathcal characters look (so it's not the same as \mathscr)
\DeclareSymbolFont{usualmathcal}{OMS}{cmsy}{m}{n}
\DeclareSymbolFontAlphabet{\mathcal}{usualmathcal}


%-- Science  ----------------------------------------

\usepackage{siunitx}
\usepackage[version=4]{mhchem}

%-- Math  -------------------------------------------

\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{braket}
\usepackage{tensor}

\newtheorem{proposition}{Proposition}
\newtheorem{conjecture}{Conjecture}
\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}

%-- Graphics  ---------------------------------------

\usepackage{tikz-cd}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{float}

%-- User-defined ------------------------------------

% boolean variable for final version, e.g. high res figures, ...
\newboolean{final}
\setboolean{final}{false}
\usepackage[subrefformat=parens,labelformat=parens]{subcaption}
\usepackage{booktabs}

\input{commands}
\input{figures}

\begin{document}

% TODO: write your article's title here.
% The article title is centered, Large boldface, and should fit in two lines
\begin{center}{\Large \textbf{
 A $C^\ast$-algebraic view on the interaction of real- and reciprocal space topology in skyrmion crystals
}}\end{center}

% TODO: write the author list here. Use first name (+ other initials) + surname format.
% Separate subsequent authors by a comma, omit comma and use "and" for the last author.
% Mark the corresponding author with a superscript star.
\begin{center}
Pascal Prass\textsuperscript{1}${}^\star$,
Fabian R. Lux\textsuperscript{2},
Emil Prodan\textsuperscript{2},
Duco van Straten\textsuperscript{4} and
Yuriy Mokrousov\textsuperscript{1,3}
\end{center}

% TODO: write all affiliations here.
% Format: institute, city, country
\begin{center}
{\bf 1} \mainzP
\\
{\bf 2} \nyc
\\
{\bf 3} \pgi
\\
{\bf 4} \mainzM
\\
% TODO: provide email address of corresponding author
${}^\star${\small \sf pprass@uni-mainz.de}
\end{center}

\begin{center}
\today
\end{center}

% For convenience during refereeing (optional),
% you can turn on line numbers by uncommenting the next line:
% \linenumbers
% You should run LaTeX twice in order for the line numbers to appear.

\section*{Abstract}
{\bf
% TODO: write your abstract here.
%The abstract is in boldface, and should fit in 8 lines.
%It should be written in a clear and accessible style, emphasizing the context, the problem(s) studied, the methods used, the results obtained, the conclusions reached, and the outlook. You can add a table contents, recommended if your paper is more than 6 pages long.
Understanding the interaction of real- and reciprocal space topology in skyrmion crystals is an open problem.
We approach it from the viewpoint of $C^\ast$-algebras and calculate all admissible Chern numbers of a strongly coupled tight-binding skyrmion system on a triangular lattice as a function of Fermi energy and texture parameters.
Our analysis reveals the topological complexity of electronic states coupled to spin textures, and the failure of the adiabatic picture to account for it in terms of emergent electromagnetism. On the contrary, we explain the discontinuous jumps in the real-space winding number in terms of collective evolution in real-, reciprocal, and mixed space Chern numbers. Our work sets the stage for further research on topological dynamics in complex dynamic spin textures coupled to external fields.
}

% TODO: include a table of contents (optional)
% Guideline: if your paper is longer that 6 pages, include a TOC
% To remove the TOC, simply cut the following block
\vspace{10pt}
\noindent\rule{\textwidth}{1pt}
\setcounter{tocdepth}{2}
\tableofcontents\thispagestyle{fancy}
\noindent\rule{\textwidth}{1pt}
\vspace{10pt}

\section{Introduction}
\label{sec:introduction}

% -- general words of introduction
Understanding the electronic properties of noncollinear magnetic systems is crucial for their implementation as novel, energy-efficient bits of information~\cite{Fert2013, Fert2017, Back2020}. 
A rich class of noncollinear magnets is represented by the family of so-called magnetic multi-$q$ states: periodic arrangements of the local magnetic moments, dominated by their lowest order Fourier modes~\cite{Heinze2011,Hayami2021,Shimizu2022}.  
The homogeneity of these textures makes them ideal candidates to gain a deeper insight into the electronic structure of noncollinear magnetic materials and the interplay of topological features in real- and reciprocal space~\cite{Hamamoto2015,Gobel2017,Gobel2017b,Lux2024,Matsui2021,Tome2021,Gong2021,Divic2022,Hayami2023}.
The multi-$q$ texture that holds the highest significance for the context of our work is the multi-$q$ skyrmion lattice. 
For example, skyrmionic states of this type appear in the family of chiral $B20$ materials such as \ce{MnSi} \cite{Muhlbauer2009, Neubauer2009} and \ce{Fe_{1-x}Co_{x}Si} thin films \cite{Munzer2010,Yu2010}, chiral multiferroic insulators such as \ce{Cu2OSeO3}~\cite{Seki2012, Langner2014}, and have also been discovered in centrosymmetric materials such as $\ce{Gd2PdSi3}$~\cite{Kurumaji2019} and $\ce{GdRu2Si2}$~\cite{Khanh2020}.

% -- explain the interplay of real and reciprocal space topology and how little we know about their interaction 
When the length scale of a skyrmionic multi-$q$ texture approaches the lattice constant of its host material, the resulting interference effects can lead to the formation of gapped topological states in the electronic system of the host material, manifesting for example, as a quantized topological Hall effect \cite{Hamamoto2015}.
Traditionally, this is explained through the language of emergent magnetic fields~\cite{Bruno2004, Fujita2011, Everschor2014}: using a unitary transformation, a noncollinear magnetic state can be rotated into a collinear co-moving frame of reference at the price of a modified kinetic energy which now resembles the presence of an electromagnetic vector potential. 
In the strong coupling limit of smooth textures, this analogy becomes exact with a corresponding ``emergent" magnetic field, assuming the form 
\begin{align}
    B_{\mathrm{em}} = \frac{\hbar}{2e} 
    \hatn \cdot (\partial_x \hatn \times \partial_y \hatn),
\end{align}
where $\hatn \colon \mathbb{R}^2\to \mathbb{R}^3$ with $\| \hatn \| = 1$ describes a smooth skyrmion texture in two dimensions.
This implies that a smooth multi-$q$ skyrmion system at strong coupling (i.e.~in the adiabatic limit) can be mapped onto the Hofstadter model \cite{Hofstadter1976},
which can explain the formation of a gap in the electronic spectrum and its topological nature \cite{Hamamoto2015, Thouless1982}.

% -- portrait our formalism as a means of studying this interaction in detail
Finding a more general description of the effect is desirable. 
A suitable formalism would not rely on the adiabatic limit and, therefore, it would have a wider range of applicability \cite{Matsui2021}.
In \cite{Lux2024}, we argue that all phenomena related to the presence of emergent fields are encoded in the observable algebra of the multi-$q$ system, irrespective of any assumption about adiabaticity.
An observable algebra is a so-called $C^\ast$-algebra \cite{Murphy1990} containing all translations of the Hamiltonian and other observables which can be represented as bounded, self-adjoint operators on a physical Hilbert space.
For multi-$q$ systems, the observable algebra has a finite number of non-trivial equivalence classes of projections as described by operator $K$-theory \cite{Rordam2000}. 
Therefore, the gaps in the energy spectrum and their corresponding Fermi projections can be classified by a complete set of topological invariants including the ones responsible for quantized contributions to the Hall conductivity.
The formalism in \cite{Lux2024} can thus provide a topological classification of electronic states in multi-$q$ magnets without the need to refer to smooth magnetic textures or the adiabatic limit.

% -- summarize the main results of the paper. which expectations have been confirmed? what was surprising? circle back to this point at the end of the paper
In this work, we demonstrate how to calculate all topological invariants of the observable algebra, which are real-, reciprocal, and mixed space Chern numbers, and determine them numerically for the triangular $3q$ skyrmion lattice over a range of texture parameters.
In doing so, we obtain an exhaustive topological classification that uniquely identifies the $K$-theory classes of one of the standard models displaying a quantized topological Hall effect~\cite{Hamamoto2015}~\cite{Gobel2017, Gobel2017b}.
Our main findings are threefold: first, we find a single electronic band at the van-Hove singularity carrying the full contribution to the real-space Chern number. 
The second result concerns the relationship between the momentum space Chern number and the texture's real-space winding, which we find to be more intricate than traditionally assumed.
%third: topological phase transitions (leaving the algebra)
Thirdly, we study the evolution of the electronic topology across various phase transitions of the magnetic texture in real space and find that the observability of associated spectral flow is related to subtleties of the observable algebra.
The existence of these gapless modes is related to the topology of the point defects which emerge at the transition parameter~\cite{Teo2010}.
In summary, our work leverages the tools of noncommutative geometry to achieve a fine-grained understanding of the electronic states in multi-$q$ textures, which we believe to be key for the educated design of new topological materials based on magnetic structures.

The paper is organized into six sections. 
Section \ref{sec:multi_q_magnets} formalizes the general mathematical properties of magnetic multi-$q$ textures, which form the basic ingredients for going into the formulation of the electronic observable algebra, presented in section \ref{sec:observable_algebra}. We focus on the real-space topological classification and demonstrate how parameter-dependent transitions between different topological phases occur.
Section \ref{sec:observable_algebra} identifies the observable algebra and its faithful representations, and we introduce a differential calculus, i.e., a trace and derivations, from which we construct the Chern characters.
For numerical evaluation, the observable algebra and its differential calculus need to be approximated to the finite-volume case. This is done in section \ref{sec:computation} together with a discussion of this approximation and its error bounds.
With this computational method, the Chern numbers of gaps in the skyrmion crystal system are evaluated in section \ref{sec:results}.
We determine all Chern numbers for selected gaps and calculate the corresponding integer labels. This way, we verify their numerical precision and identify the Chern numbers of further interest.
Next, we compute the main Chern numbers in dependence on the Fermi energy for selected texture parameters belonging to different topological phases of the texture. From this, we can identify which energy states contribute to which Chern number and how this depends on the texture's winding density.
Finally, we compute the main Chern numbers for the Fermi energy in one fixed gap over a range of parameters, probing the transition between the texture's topological phases and compiling a phase diagram for the full range of texture parameters. From this, we identify the order parameters corresponding to the topological phase transition. %The manuscript ends with a discussion.

\section{Properties of multi-\texorpdfstring{$q$}{q} magnetic systems}
\label{sec:multi_q_magnets}

\subsection{On the definition of multi-\texorpdfstring{$q$}{q} order}
\label{subsec:definition}

% -- definition of multi-q magnetic order
To begin with, we consider a general periodic texture $\vec{n}\colon \mathbb{R}^d\to \mathbb{R}^3$ whose Bravais lattice can be constructed from the vectors $\vec{L}_1, \ldots, \vec{L}_d$. 
In other words, these textures are invariant under the action of the discrete translation group $\{m_1 \vec{L}_1 + \ldots  + m_d \vec{L}_d| \vec{m}\in\mathbb{Z}^d\} \subset \mathbb{R}^d$.
Denote the basis for the corresponding reciprocal lattice by 
$\vec{Q}_1, \ldots, \vec{Q}_d$, characterized by the property $\vec{L}_i \cdot \vec{Q}_j = 2\pi \delta_{ij}$. 
The resulting reciprocal lattice then comes in the form of
\begin{equation}
    \vec{G}_{\vec{m}} = m_1 \vec{Q}_1 + \ldots  + m_d \vec{Q}_d,
    \label{eq:Gm_definition}
\end{equation}
with $\vec{m} \in \mathbb{Z}^d$.
As long as the texture $\vec{n}$ is integrable within its unit cell, a lattice Fourier series can be given in the form  of
\begin{align}
  \vec{n}(\vec{x}) & =  \sum_{\vec{m} \in  \mathbb{Z}^d}  \vec{n}_{ \vec{G}_{\vec{m}}} e^{+ i  \vec{G}_{\vec{m}} \cdot \vec{x} },
  \\
   \vec{n}_{ \vec{G}_{\vec{m}}} & = \frac{1}{V_{uc}} \int\limits_{ V_{uc}} \dd \vec{x} ~ \vec{n}(\vec{x} ) e^{- i  \vec{G}_{\vec{m}} \cdot \vec{x} } .
\end{align}
The decay rate of the Fourier coefficients $\vec{n}_{ \vec{G}_{\vec{m}}}$ as a function of increasing $\| \vec{m} \|$ is controlled by the smoothness of the texture.
A textbook example is the discontinuous square wave $n(x) = \mathrm{sgn}(\sin (x) )$ in one dimension whose Fourier coefficients $n_m$ decay only as $1/m$.
In contrast, for a sufficiently smooth texture, the Fourier decomposition will be dominated by its lowest order terms and one can take this as one hallmark of multi-$q$ magnetic order.

In this regime, a periodic magnetic texture can be thought of as a linear superposition of a few fundamental modes, fully characterized by a set of $r$ coexisting wave vectors $\vec{q}_1, \ldots \vec{q}_r$ together with their initial phase conditions $\varphi_1, \ldots, \varphi_r$ and amplitudes $\vec{n}_{\vec{q}_{1}},\ldots, \vec{n}_{\vec{q}_{r}}$ at the origin of some arbitrary, but fixed coordinate system:
\begin{equation}
    \vec{n}(\vec{x})\approx \sum_{i=-r}^r  \vec{n}_{\vec{q}_{i}}e^{i(\vec{q}_i\cdot\vec{x}+\varphi_{i})}
    \label{eq:fourier_modes}
\end{equation}
with $\vec{q}_{-i}\coloneqq -\vec{q}_i$, $\vec{n}_{\vec{q}_{-i}}\coloneqq\vec{n}_{\vec{q}_{i}}^\ast$, and zero mode with $\vec{q}_0=0$, $\varphi_0=0$, and $\vec{n}_{\vec{q}_0}\in\mathbb{R}$.
The initial phase conditions are put in by design to clarify the intended phases at the origin and could be absorbed by the complex amplitudes.
The $q$-vectors in the summation above can be any of the reciprocal lattice vectors $\vec{G}_{\vec{m}}$ with the coefficients $m_i \in \lbrace -1,0,1\rbrace$ (see Eq.(\ref{eq:Gm_definition})), i.e., the lowest order Fourier modes.
Thus, $r$ may exceed the dimensionality $d$.
In general, the vector field $\vec{n}(\vec{x})$ has lost its normalization after the truncation of higher-order modes. 
A reconstruction of the normalization as $\hatn(\vec{x})=\vec{n}(\vec{x})/||\vec{n}(\vec{x})||$ still gives an excellent approximation to the original vector field  albeit for the price of re-introducing higher order modes.
Examples of multi-$q$ textures of this kind include the $A$-phase of MnSi which is characterized by three $q$-vectors~\cite{Neubauer2009}, or the atomic scale skyrmion lattice in Fe/Ir(111) thin films which exhibits a superposition of two $q$-vectors~\cite{Heinze2011}.
The most fundamental example, however, is the stationary spin-wave: a single-$q$ state with only one mode, describing a plane wave of magnetic moments which manifests itself for example in the helimagnetic phases of $\ce{MnSi}$~\cite{Ishikawa1976, Hansen1977,Plumer1981, Bauer2017} or $\ce{FeGe}$~\cite{Ludgren1970,Lebech1989}.

One can now go as far as to take these stationary spin waves as the fundamental building blocks for more general magnetic textures by selecting arbitrary $q$-vectors from possibly different, and even outright incommensurate reciprocal lattices before assembling them in a linear superposition.
This encompasses the Fourier truncation of lattice-periodic textures as a special case but contains more general textures such as~e.g.~aperiodic Moir\'e patterns \cite{Shimizu2021}.
From now on, we parameterize these more general superpositions as
\begin{equation}
    \vec{n}(\vec{x})=\sum_{i=1}^r \left(\psi_i^c \ivec^c \cos(\vec{q}_i\cdot\vec{x}+\varphi_i) + \psi_i^s \ivec^s \sin(\vec{q}_i\cdot\vec{x}+\varphi_i) \right) + m \hat{\vec{e}}^0,
\label{eq:superposition}
\end{equation}
which can be seen to be the equivalent trigonometric formulation of Eq.~(\ref{eq:fourier_modes}) and which is more commonly used in the literature on multi-$q$ states, e.g., \cite{Shimizu2021,Shimizu2022, Nakazawa2019, Freimuth2013}.
Here, $\psi_i^c$, $\psi_i^s$ are the amplitudes of the cosinusoidal and sinusoidal waves with the wave vectors $\vec{q}_i$, respectively, $\ivec^c$ and $\ivec^s$ are unit vectors, and $\hat{\vec{e}}^0$ is another independent unit vector for the direction of the constant net magnetization of magnitude $m$. In case of a normalized texture $\hatn(\vec{x})=\vec{n}(\vec{x})/||\vec{n}(\vec{x})||$, $m$ no longer determines the actual net magnetization but is still a related parameter. For example, one has $\lim_{m\to\infty} \hatn(\vec{x}) = \hat{\vec{e}}^0$, the collinear ferromagnet.

% -- phase space
A texture which is constructed this way from $r$ spin waves depends on the $r$ corresponding phases $\omega_i: \mathbb{R}^d \to S^1$, $\omega_i(\vec{x})=(\vec{q}_i\cdot\vec{x}+\varphi_i)~\mod 2\pi$.
However, these phases are in general not independent of one another, as they are determined by the choice of the $q$-vectors.
The phase values which can be reached at the same point in real space lie in the image of the map $\vec{\omega}: \mathbb{R}^d\to T^r$.
Only if one has $r$ $\mathbb{R}$-linear independent $q$-vectors every point in this phase space can be accessed, which is only possible for $r\leq d$.
One can also consider the scenario where a selection of $q$-vectors is linearly dependent.
The dimension of the image $\vec{\omega}(\mathbb{R}^d)$ is then not immediately apparent: 
let $\tilde{r}$ denote the dimension of the linear subspace of $\mathbb{R}^d$ spanned by the $r$ wave vectors.
In case that the $\mathbb{R}$-linear dependent wave vectors are also linear dependent over $\mathbb{Q}$, there exists a rational relation between the phases and the texture is periodic. Then, the image $\vec{\omega}(\mathbb{R}^d)\subset T^r$ is of dimension $\tilde{r}$ and isomorphic to $T^{\tilde{r}}$.
Otherwise, it may be dense in a submanifold of $T^r$ with dimension equivalent to the number of rationally independent wave vectors.
This is the case for $q$-vectors from incommensurate lattices rendering the texture aperiodic.
A simple example in $d=1$ are two spin waves with phases of an irrational slope ratio, which wrap densely around $T^2$.

\subsection{Real-space topological classification of multi-\texorpdfstring{$q$}{q} textures}
\label{subsec:real_space_classification}

Coming back to the case of periodic textures, there can be at most $d$ $\mathbb{Q}$-linear independent $q$-vectors and one has fixed rational relations between the initial phases.
In the following the periodic case with $\tilde{r}=d$ is assumed.
As the texture consists of a finite sum of smooth functions over $S^1$, it can be considered as an element of $C^\infty(T^d, \mathbb{R}^3)$, the space of smooth maps from the $d$-torus to $\mathbb{R}^3$.
Whenever $\| \vec{n}(\vec{x}) \| > 0 $ for all $\vec{x} \in \mathbb{R}^d$, the normalization procedure will lead to a smooth field of unit vectors $\hatn$, and thus $C^\infty(T^d, S^2)$.
By setting $\vec{x}=0$, one can conveniently address $T^r$ with the corresponding $\varphi_i$ and restrict it to $T^d$ by using the phase relations.

The topological classification of these maps is based on the concept of homotopy.
Two maps $f,g \in C(T^d, S^2)$ are called homotopic if there exists a continuous function
$
    H\colon T^d\times [0,1] \to S^2,
$
such that $H(t,0) = f(t)$ and $H(t,1)=g(t)$~\cite[Ch.~7]{Lee2010}. Homotopy forms an equivalence relation on $C(T^d, S^2)$ with a corresponding quotient space denoted by $[T^d, S^2]$ - the space of homotopy classes.
The most well-studied example of such quotients is the so-called homotopy groups of the sphere $\pi_n(S^k) = [S^n, S^k]$.
In dimension two with two linear independent $q$-vectors, the elements of $[T^2, S^2]$ can be classified by their topological degree.
Loosely speaking, the degree of a map $f$ counts the number of times the domain of $f$ is wrapped around the image of $f$. 
Since the texture $\hatn \in C^\infty(T^2,S^2)$ is smooth in addition to being continuous (in fact, every element of $[T^2, S^2]$ is homotopic to a smooth map), the degree of $\hatn$ can be calculated as \cite[Thm.~17.35]{Lee2012}
\begin{align}
    \mathrm{deg}~ \hatn = \frac{1}{4 \pi } \int\limits_{T^2} \dd \vec{\varphi} ~\hatn \cdot( \partial_{\varphi_1} \hatn \times \partial_{\varphi_2} \hatn) 
    \in \mathbb{Z}.
    \label{eq:degree}
\end{align}
If one has two continuous maps $f,g \colon T^2 \to S^2$, then $\mathrm{deg}~f = \mathrm{def}~g$ if and only if $f$ and $g$ are homotopic -- a result known as Hopf's theorem \cite[p.~51]{Milnor1965}. 
Therefore, Hopf's theorem provides an isomorphism $[T^2, S^2] \cong \mathbb{Z}$ which provides a means of topological classification.

\subsection{Topological phase transitions in real-space}
\label{subsec:real_space_phase_transitions}

Parameter manipulation, such as tuning the spin waves' phase relations $\varphi_i$ or varying the ferromagnetic degree of freedom $m$, changes the superposition in Eq.~(\ref{eq:superposition}) smoothly. 
However, tuning the parameters over certain critical points can lead to destructive interference.
In this case, $\| \vec{n}(\vec{x}_c) \| = 0$ will occur at critical positions $\vec{x}_c$ in real-space.
The normalization procedure is thus undefined at $\vec{x}_c$ and no matter which choice will be made to redefine $\hatn(\vec{x})$, the resulting function $\hatn(\vec{x})$ will be discontinuous at the singularities $\vec{x}=\vec{x}_c$.
This is of significant consequence, as the spectral properties of an electronic system coupled to this texture are sensitive to the topology of its singularities~\cite{Teo2010}.
In practice, we can regularize the singularity by making the choice
\begin{align}
    \hatn = \frac{\vec{n}}{ \| \vec{n} \| } \longrightarrow   \frac{\vec{n}}{ \| \vec{n} \| +  \eta }  =   \hatn_\eta ,
    \label{eq:regularize}
\end{align}
with $\eta >0 $. It is then guaranteed that $\lim_{\eta \to 0^+}\hatn_\eta = \hatn$ for all $\vec{x} \neq \vec{x}_c$. 

We want to give a simple example that can be worked out exactly and that can serve as a toy model for more complex magnetic transitions. 
Consider the isolated skyrmion, parameterized in polar coordinates by
\begin{align}
    \vec{n}_{\mathrm{sk}}(\phi, \rho) = ( \sqrt{1-n_z(\rho)^2} \cos(\Phi(\phi)), \sqrt{1-n_z(\rho)^2} \sin(\Phi(\phi)), n_z(\rho))^T,
\end{align}
where the polar angle of the vector direction $\Phi(\phi)=-\phi$ is opposite to the polar angle $\phi\in[0,2\pi)$ of the coordinates, and the $z$-component $n_z(\rho) = (2\rho-1) \Theta(1-\rho) + \Theta(\rho-1)$ with the Heaviside step function $\Theta$ and $\Theta(0)=\frac{1}{2}$ only depends on the radius $\rho\in[0,\infty)$, such that the texture is that of a ferromagnet for radius $\rho\geq 1$.
To remain consistent with the framework of multi-$q$ textures, we can envision that this skyrmion occupies the cartesian unit cell $V_{uc} = [-1,1] \times [-1,1] \subset \mathbb{R}^2$.
One has $\|  \vec{n}_{\mathrm{sk}} \| = 1$ and a topological charge $\deg~\vec{n}_{\mathrm{sk}} = 1$.
We construct a linear interpolation to the ferromagnet by
\begin{align}
    \vec{n}(\phi, \rho, t) =  (1-t) \vec{n}_{\mathrm{sk}}(\phi, \rho) + t  \vec{e}_z,
\end{align}
where $\vec{e}_z$ is the unit vector in $z$-direction. By design, a singularity occurs for $t=1/2$ where we find 
$ \vec{n}= 0$ at the origin.
The resulting texture can now be regularized according to Eq.~(\ref{eq:regularize}) before we calculate the winding number from formula Eq.~(\ref{eq:degree}).
The integrals can be computed analytically.
Let $t_c(\eta)$ represent the value of $t$ for which $\mathrm{deg} ~ \hatn_{\eta}$ has depleted to the value of $1/2$.
As the notation indicates, the value of $t_c(\eta)$ will generally depend on $\eta$. However, one has $t_c(\eta) \to 1/2 \equiv t_c$ for $\eta \to 0$.
Analytically, we then find the asymptotic scaling behavior (similar to \cite{Pruisken1988,Xue2013})
\begin{align}
    \mathrm{deg} ~ \hatn_{\eta}(t) \sim  F\left( (t-t_c )  (\eta /\eta_0)^{-\kappa}  \right), ~~ \text{for}~\eta \to 0^+,
\end{align}
where $\eta_0 = 1$, $\kappa =1$, and where $F$ is the universal scaling function of the transition, explicitly given by
\begin{align}
    F(x) = \frac{1}{2} \left( 1- \frac{x}{1+ \frac{4 x^2}{1+4|x|}} \right).
\end{align}
Moreover, one finds 
$
   \lim_{\eta\to 0^+} \mathrm{deg} ~ \hatn_{\eta}(t) = \Theta(t_c -t),
$
for all $t\neq 1/2$. In summary, this example illustrates how topological invariants associated with a normalized multi-$q$ texture in real-space, such as its winding number,  can change discontinuously as a function of the texture parameters \cite{Hayami2021,Shimizu2022}. 
This is because, at the critical point, the texture ceases to be continuous, and its topological degree is not defined. The discontinuous transition can be turned into a continuous one at the price of momentarily leaving the function space  $C(T^2, S^2)$ in favor of $C(T^2, \mathbb{R}^3)$, thus leaving the door open for a continuous change of the degree.

\subsection{Multi-\texorpdfstring{$q$}{q} systems coupled to lattice electrons}
\label{subsec:multi_q_lattice}

Instead of the continuum $\mathbb{R}^d$, multi-$q$ textures are often studied from the perspective of an electronic tight-binding Hamiltonian which is hosted by its own respective Bravais lattice \cite{Hamamoto2015, Gobel2017}. 
This Bravais lattice can generally be different from the Bravais lattice of the magnetic texture, and interesting band structure effects can result from the interference of these two patterns.
Therefore, we choose a different notation for this case and define the $d$-dimensional electronic Bravais lattice by specifying its lattice vectors $\{\vec{a}_i\}$ and reciprocal lattice vectors $\{\vec{b}_j\}$, such that $\vec{a}_i\cdot \vec{b}_j=2\pi\delta_{ij}$.
The $r$ wave vectors $\{\vec{q}_i\}$ of the multi-$q$ texture can now be decomposed into $\vec{q}_i=\sum_j^d \theta_{ij} \vec{b}_j$. 
Accordingly, the real-space position of the lattice site with integer label $\vec{m}\in\mathbb{Z}^d$ is $\vec{x}_{\vec{m}}=\sum_j^d m_j \vec{a}_j$.
This gives
\begin{align}
     \vec{x}_{\vec{m}} \cdot \vec{q}_i 
   = \sum_{kl} m_k \theta_{il} \vec{a}_k \cdot \vec{b}_l 
   = 2\pi \sum_{k} m_k \theta_{ik}  \equiv 2\pi ~\vec{m}\cdot \vec{\theta}_i,
\end{align}
where $(\boldsymbol{\theta}_i)_k=\theta_{ik}$ .
This way, the coefficients $\theta_{ij}$ indicate by how much the phase $\omega_i(\vec{x}_{\vec{m}})$ of wave $i$ changes if one moves one site along $\vec{a}_j$.
We denote the phase values modulo $2\pi$ by $[x] = x \mod 2\pi  \in [0,2\pi)$ for all $x\in \mathbb{R}$. 
Then, the phase factors can be written as
\begin{equation}
\omega_i(\vec{x}_{\vec{m}})=[\vec{x}_{\vec{m}}\cdot \vec{q}_i + \varphi_i ] = [2\pi~\vec{m}\cdot \vec{\theta}_i + \varphi_i ],
\end{equation}
where $\varphi_i$ is the phase of wave $i$ at the origin $\vec{x}_{\vec{0}}=\vec{0}$ \cite{Lux2024}.
In matrix notation, one can give a more compact description in terms of
\begin{align}
    \vec{\omega}(\vec{x}_{\vec{m}}) = [2\pi ~\theta  \vec{m} + \vec{\varphi}] .
\end{align}
The natural action $\tau$ of the lattice translation group $\mathbb{Z}^d$ on the waves phases is defined by
\begin{equation}
    \vec{\omega}(\vec{x}_{\vec{m}+\vec{l}})= [ 2\pi\theta(\vec{m}+\vec{l})  + \vec{\varphi} ]
    =
    [\vec{\omega}(\vec{x}_{\vec{m}}) + 2\pi \theta \vec{l} ]  \equiv \tau_{\vec{l}}  \vec{\omega}(\vec{x}_{\vec{m}})
    \label{eq:phasetranslations}
\end{equation}
with $\vec{l}\in\mathbb{Z}^d$.
If we take the right-hand side as the definition of $\tau$, we can relate all phase factors to the origin:
\begin{align}
    \vec{\omega}(\vec{x}_{\vec{m}}) = \tau_{\vec{m}}  \vec{\omega}(\vec{x}_{\vec{0}})
    = \tau_{\vec{m}}  \vec{\varphi} .
    \label{eq:phaseorigin}
\end{align}
It is then possible to take a look at the entire orbit under lattice translations
\begin{align}
    \mathbb{Z}^d \vec{\varphi}
    = \lbrace \tau_{\vec{m}}  \vec{\varphi}  ~|~ \vec{m} \in \mathbb{Z}^d\rbrace  \subset T^r,
\end{align}
and refer to the closure of $\mathbb{Z}^d \vec{\varphi}$ in $T^r$ as the hull $\Omega$ of the magnetic pattern.
If the translation action is ergodic on $T^r$, e.g. for $r$ $\mathbb{R}$-linear independent lattice incommensurate wave vectors with $\theta_{ik}\in\mathbb{R}\setminus\mathbb{Q}$, then $\mathbb{Z}^d \vec{\varphi}$ will form a dense subset of $T^r$ whose closure is $\Omega = T^r$ for all $\vec{\varphi} \in T^r$.
For the remainder of this work, we assume either immediately this case or we take on a periodic multi-$q$ texture with some rationally linear dependent lattice incommensurate wave vectors.
Then, we can replace the dependent phases using the rational phase relations, thereby reducing
$r$ to $\tilde{r}$, the number of $\mathbb{R}$-linear independent wave vectors, to return to the first case with ergodicity on $T^{\tilde{r}}$.

\subsection{The hexagonal skyrmion crystal on the triangular lattice}
\label{subsec:our_model}

The focus of this work is on the skyrmionic $3\vec{q}$-state, supported by a triangular lattice.
Its spin texture is given by the normalized superposition of $r=3$ spin helices in two-dimensional real-space ($d=2$) with wave vectors of equal length $q$ that sum up to zero ($120^\circ$ apart from each other) as illustrated in Fig. \ref{fig:3Qskx}:
\begin{equation}
    \vec{q}_1=\begin{pmatrix} \frac{\sqrt{3}q}{2}, & -\frac{q}{2}, & 0 \end{pmatrix}^T,\qquad
    \vec{q}_2=\begin{pmatrix} 0, & q, & 0 \end{pmatrix}^T,\qquad
    \vec{q}_3=\begin{pmatrix} \frac{-\sqrt{3}q}{2}, & -\frac{q}{2}, & 0 \end{pmatrix}^T.
\end{equation}
The respective amplitudes are $1/\sqrt{3}$ and the unit vectors create a helical wave, i.e., $\ivec^c$ directs out of the plane in the $z$-direction and $\ivec^s$ is orthogonal to $\vec{q}_i$ and $\ivec^c$, such that they form a right-handed basis of $\mathbb{R}^3$. 
The constant phase shifts in this scenario provide only one additional degree of freedom (up to real-space translation): their sum $\varphi_1+\varphi_2+\varphi_3=\varphi$. The resulting vector field is given by the normalization $\hatn$ of the superposition $\vec{n}$ \cite{Shimizu2022}:
\begin{align}
    \vec{n}(\vec{x})
    &= \sum_{i=1}^3 \left(\frac{1}{\sqrt{3}} \zvec \cos(\vec{q}_i\cdot\vec{x}+\varphi_i) + \frac{1}{\sqrt{3}} (\hat{\vec{q}}_i\times\zvec) \sin(\vec{q}_i\cdot\vec{x}+\varphi_i) \right) + m \zvec \label{eq:skx_texture}\\
    &= \sum_{i=1}^3 \left(\vec{n}_i e^{i(\vec{q}_i\cdot\vec{x}+\varphi_{i})} + \vec{n}_i^* e^{-i(\vec{q}_i\cdot\vec{x}+\varphi_{i})} \right) + m \zvec,
\end{align}
with $\vec{n}_i=\frac{1}{2\sqrt{3}}(\zvec - i \hat{\vec{q}}_i\times\zvec)$. We consider this texture on a two-dimensional triangular lattice with real- and reciprocal space lattice vectors:
\begin{align}
    \vec{a}_1&=\begin{pmatrix} 1, & 0, & 0 ,\end{pmatrix}^T, &
    \vec{a}_2&=\begin{pmatrix} \frac{1}{2}, & \frac{\sqrt{3}}{2}, & 0 \end{pmatrix}^T,\\
    \vec{b}_1&=2\pi \begin{pmatrix} 1, & -\frac{1}{\sqrt{3}}, & 0 \end{pmatrix}^T, &
    \vec{b}_2&=2\pi \begin{pmatrix} 0, & \frac{2}{\sqrt{3}}, & 0 \end{pmatrix}^T.
\end{align}
As required, it is $\vec{a}_i\cdot \vec{b}_j=2\pi\delta_{ij}$. 
Expanding the $q$-vectors in the reciprocal lattice vector basis, we find
\begin{equation}
    \vec{q}_1 = \frac{q\sqrt{3}}{4\pi} \vec{b}_1, \quad \vec{q}_2 = \frac{q\sqrt{3}}{4\pi} \vec{b}_2, \quad \vec{q}_3 = \frac{q\sqrt{3}}{4\pi} (-\vec{b}_1-\vec{b}_1).
\end{equation}
Let $\vartheta=\frac{q\sqrt{3}}{4\pi}$, then the decomposition coefficient matrix $\theta$ is given by:
\begin{equation}
    \theta = \vartheta \begin{pmatrix} 1 & 0 \\ 0 & 1 \\ -1 & -1 \end{pmatrix}.
\end{equation}
Of course, the third phase factor is artificial in the sense that three coplanar vectors cannot be linearly independent. 
As such, it can be eliminated from the whole description of the texture from the start with $r=2$ and the minimal $\theta$-matrix given by $\theta= \vartheta~\mathrm{id}_2$.
However, the construction of the hexagonal skyrmion lattice is much simplified with the superfluous, yet helpful degree of freedom which can also assist in the interpretation of small angle neutron scattering data for example~\cite{Muhlbauer2009}.

\figureI

The degree of $\hatn \in C^\infty(T^2,S^2)$, introduced in Eq.~(\ref{eq:degree}) is the first important order parameter characterizing the texture.
In Fig. \ref{fig:3QskxPD} (a), we show how $\deg \hatn$ depends on $m$ and $\varphi$, thereby reproducing the result of \cite[Fig.~6]{Shimizu2022}.
Implicit equations for the phase boundaries were already determined in \cite[Eq.~(29)]{Shimizu2022}.
Another relevant order parameter of $\hatn \in C^\infty(T^2,S^2)$ for the interpretation of the electronic phase diagrams later on is the net magnetization
\begin{align}
    \braket{\hatn} = \lim\limits_{|V|\to\infty} \frac{1}{|V|} \int\limits_V \dd^2 \vec{x} ~ \hatn(\vec{\omega}(\vec{x})) =\frac{1}{|T^2|}
\int\limits_{T^2}\dd^2\vec{\varphi} ~ \hatn(\vec{\varphi}),
\label{eq:magnetization_formula}
\end{align}
where the transition from real space to the $2$-torus of phases is understood in the sense of section~\ref{subsec:real_space_classification}.
One finds $\braket{\hat{n}_x} =\braket{\hat{n}_y}=0$, while $\braket{\hat{n}_z}$ shows a nontrivial dependence on $m$ and $\varphi$ as demonstrated by Fig.~\ref{fig:3QskxPD} (b).
When $\braket{\hatn} = 0$, the magnetic texture is time-reversal invariant modulo a proper Euclidean symmetry operation. 
Since this imposes additional constraints on the associated electronic system, we plot the resulting phase boundary as a solid black line in Fig.~\ref{fig:3QskxPD}b).

\figureII

Mathematically, important topological properties of the electronic system coupled to this magnetic texture can be discovered when $\vartheta$ takes irrational values.
In this case, the map
\begin{align}
   \mathbb{Z}^2 \ni (m_1,m_2) \mapsto ( [2\pi \vartheta m_1 + \varphi_1], [2\pi\vartheta m_2 + \varphi_2] ) = (\omega_1, \omega_2) \in T^2
\end{align}
samples the torus $T^2$ densely. 
To see that this is true, note the independence of $m_1$ and $m_2$ which are uniquely associated with either $\omega_1$ or $\omega_2$.
We can therefore reduce the proof of the claim above to the following proposition:
The set $\lbrace [2\pi \vartheta m + \varphi] ~|~ m \in \mathbb{Z}\rbrace$ is dense in $[0,2\pi)$ for arbitrary $\varphi \in \mathbb{R}$ and $\vartheta \in \mathbb{R}\setminus \mathbb{Q}$.
A proof can be found in \cite{Weyl1916} and \cite[Prop. 1.3.3.]{Katok1995}.
For the two-dimensional skyrmion lattice just discussed, the hull of the magnetic pattern is thus given by
\begin{align}
    \overline{
    \lbrace 
        ( [2\pi\vartheta m_1 + \varphi_1, 2\pi \vartheta m_2 + \varphi_2] )
        ~ | ~ (m_1, m_2) \in \mathbb{Z}^2
    \rbrace
    }
    \cong T^2.
\end{align}
As a consequence, the discrete --- but infinite --- electron system can ``experience'' all possible local realizations of the magnetic texture when $\vartheta$ is irrational.
This will turn out to have very useful implications in the following.

\section{The electronic observable algebra of multi-\texorpdfstring{$q$}{q} magnets}
\label{sec:observable_algebra}

We claim in \cite{Lux2024} that all possible tight-binding Hamiltonians incorporating multi-$q$ magnetic order are representations of a certain crossed product $C^\ast$-algebra
$\mathcal{A}$ as bounded operators on the Hilbert space $\mathbb{C}^2 \otimes \ell^2(\mathbb{Z}^d)$.
The algebraic structure of $\mathcal{A}$ encodes the essential physical properties of electrons in multi-$q$ magnets. 
In this section, we want to demonstrate why this is the case.

The emergence of magnetism in crystalline materials is a complex physical phenomenon, combining the special theory of relativity (in the form of the electron spin), quantum mechanics (due to the Pauli principle), and electromagnetism.
On the level of Kohn-Sham density functional theory, a magnetic material comprising interacting electrons can be described by an
effective non-interacting Hamiltonian~
\cite{Kohn1965,VonBarth1972}
\begin{align}
    H_{KS}= - \frac{\hbar^2}{2 m} \Delta  +  v_{\mathrm{eff}} (\vec{r}) + \vec{B}_{\mathrm{xc}}(\vec{r}) \cdot \bsigma ,
\end{align}
where $v_{\mathrm{eff}} (\vec{r})$ is the effective scalar potential, while $\vec{B}_{\mathrm{xc}}(\vec{r})$ captures the exchange-correlation effects responsible for the emergence of magnetic order.
We assume that $\vec{B}_{\mathrm{xc}}(\vec{r})$ is a continuous vector field.
This is the case, for example, in the local spin-density approximation to the exchange-correlation potential \cite{VonBarth1972}.
The basic toy model which describes some essential aspects of electrons in skyrmion materials can be either seen as a discretization of this Hamiltonian or as a projection onto local $s$-orbitals, given by the tight-binding Hamiltonian
\begin{equation}
    H =  -\hop \sum_{\braket{\vec{i},\vec{j}} \in \mathbb{Z}^{2d}}  \ket{\vec{i}}\bra{\vec{j}} + \xc  \sum_{\vec{i}\in \mathbb{Z}^d} \bsigma \cdot \vec{n}(\vec{x}_{\vec{i}})   \ket{\vec{i}}\bra{\vec{i}},
    \label{eq:tbHamiltonian}
\end{equation}
where $\braket{\vec{i},\vec{j}}$ indicates the restriction of the sum to nearest-neighbor pairs in the $d$-dimensional lattice. The parameter $\hop$ describes the hopping parameter, while $\xc$ describes the coupling strength to the magnetic texture $\vec{n}$ with $\bsigma$ representing the vector of Pauli matrices.
The relevant Hilbert space is, therefore, $\mathcal{H}=\mathbb{C}^2 \otimes \ell^2(\mathbb{Z}^d)$, but we already want to stress that generalizations to further orbital and spin degrees of freedom, as well as next-nearest neighbor coupling and beyond, are possible for the formalism outlined below.

% -- topological equivalence
Here, we assume that the spectrum of the discrete tight-binding Hamiltonian exhibits the same topological features as the lowest part of the energy spectrum for its underlying continuum model. This has been confirmed in \cite{Shapiro2022} for the case of a constant magnetic field perpendicular to a two-dimensional crystal in the strong binding regime, i.e., the integral quantum Hall effect.

% -- smooth algebra
For completely generic, continuous textures $\vec{n} \in C( \mathbb{R}^d, \mathbb{R}^3)$, the most general algebra which contains the Hamiltonian as one of its elements is a so-called von-Neumann algebra: $\mathcal{B}(\mathcal{H})$ -- the space of bounded operators on $\mathcal{H}$.
From the topological point of view, these algebras are too large to be useful: their $K$-theory is trivial, i.e., $K_0(\mathcal{B}(\mathcal{H})) = 0$ \cite[p. 47]{Rordam2000}. 
For completely arbitrary textures, there is thus not much to be said.
The case is different for multi-$q$ systems. This is because their associated textures can be thought of as a composition of maps~\cite{Lux2024}:
\begin{equation}
    \begin{tikzcd}
	{\mathbb{R}^d} & {T^r} & {\mathbb{R}^3}
	\arrow["{\vec{\omega}}", from=1-1, to=1-2]
	\arrow["{\vec{n}}", from=1-2, to=1-3]
\end{tikzcd}
\end{equation}
with $\vec{\omega}$ as in section \ref{subsec:multi_q_lattice} and where $\vec{n}$ is a continuous function. 
This structure can be leveraged to give a very compact description of an algebra of observables which is capable of describing every tight-binding electron Hamiltonian coupled to multi-$q$ magnetic order. 
Its definition and topological classification is the subject of this section: we rewrite the tight-binding Hamiltonian of Eq.~\eqref{eq:tbHamiltonian} such that its affiliation to this algebra becomes apparent.

\subsection{Crossed product algebra}
\label{subsec:crossed_product_algebra}

% -- group action on algebra
The fundamental property that allows for a concise algebraic description is the fact that translations on the electronic lattice can be compensated by continuous shifts of the multi-$q$ texture ---  a property referred to as covariance in the mathematical literature. The resulting algebraic structures with built-in covariance are so-called crossed product $C^\ast$-algebras \cite[Ch.~7]{Pedersen2018}, which is the content of this section.

As a first observation, the group of lattice translations $\mathbb{Z}^d$ has a corresponding continuous action on the algebra of continuous functions on the $r$-torus, $C(\hull)$, given via $C^\ast$-au\-to\-mor\-phisms:
\begin{align}
    & \alpha \colon \mathbb{Z}^d \to \mathrm{Aut}( C(\hull) ), \ \vec{m} \mapsto \alpha_{\vec{m}}\\ 
    & (\alpha_{\vec{m}} f)(\vec{\varphi}) \equiv  f( \tau_{-\vec{m}}\vec{\varphi}) = f(\vec{\varphi} - 2\pi\theta\vec{m}),
\end{align}
which we want to use to build the crossed product algebra.
Recall that $\tau$ are the translations defined in Eq.~(\ref{eq:phasetranslations}).
If one denotes the abstract generators of $\mathbb{Z}^d$ by $t_1, \ldots, t_d$, then one can think of $\mathbb{Z}^d$ as an abelian group with presentation
\begin{align}
    \mathbb{Z}^d = \braket{ t_1, \ldots, t_d ~|~ t_i t_j = t_j t_i}.
\end{align}
We employ a multi-index notation and write $t^{\vec{m}} = t_1^{m_1} \ldots t_d^{m_d}$ for $\vec{m} \in \mathbb{Z}^d$.
The group algebra $\mathbb{C} \mathbb{Z}^d$ then consists of formal summations $\sum_{\vec{m} \in \mathbb{Z}^d} c_{\vec{m}} t^{\vec{m}}$, where only finitely many coefficients $c_{\vec{m}} \in \mathbb{C}$ are different from zero and the multiplication law is inherited from the group structure by a linear extension.

% -- crossed product vector space
As a vector space, the crossed product of the algebra $C(\hull)$ and the group $\mathbb{Z}^d$ is then defined as the $\mathbb{C}$-linear tensor product $C(\hull) \otimes \mathbb{C}\mathbb{Z}^d$ with a typical element in the form of
\begin{align}
    \sum_{\vec{m} \in \mathbb{Z}^d} f_{\vec{m}} \otimes t^{\vec{m}} ,
\end{align}
and where the complex coefficients now have flourished into continuous functions on $\hull$, $f_{\vec{m}}\in C(\hull)$. Still, only finitely many $f_{\vec{m}}$ are different from zero.
% -- crossed product
To obtain the algebraic structure on $C(\hull) \otimes \mathbb{C}\mathbb{Z}^d$ that is characteristic for the crossed product, one declares 
\begin{align}
    (f_1 \otimes t^{\vec{m}_1} )  (f_2 \otimes t^{\vec{m}_2} )  = f_1 \alpha_{\vec{m}_1} ( f_2)  \otimes t^{\vec{m}_1 + \vec{m}_2}.
    \label{eq:crossed_product_multiplication}
\end{align}
We denote the resulting algebraic crossed product by $C_c(\mathbb{Z}^d, C(\hull), \alpha )$.
While this description would already be sufficient to represent a wide class of model Hamiltonians $H$, the same cannot be said for their physical properties since these are encoded in the single-particle Green's function, the resolvent $(z - H)^{-1}$ for $z \in \mathbb{C}$, which is not representable as an element of $C_c(\mathbb{Z}^d, C(\hull), \alpha )$.
% -- fermi projection P_f(H)? Definition via residual calculus?
Therefore, we need a meaningful completion of the algebraic crossed product to a larger set of observables.
This requires an additional structure that is introduced in the following section.

\subsection{The noncommutative torus and its faithful representations}
\label{subsec:noncommutative_torus}

$C^\ast$-algebras have a long history in quantum mechanics \cite{Murray1936} and provide a suitable framework to make sense of operators such as the resolvent and the Fermi projection.
First, recall that a Banach algebra is an algebra $B$ over a field that is complete with respect to a norm $\| . \|$ fulfilling $\| a b \| \leq \|a \| \|b\|$ for all $a,b \in B$.
A $C^\ast$-algebra $A$ is then a complex Banach algebra with an anti-multiplicative, anti-linear involution $\ast$, i.e., a Banach $\ast$-algebra, for which the so-called $C^\ast$-identity
\begin{equation}
    \|a^\ast a \| = \|a \|^2, 
\end{equation}
is fulfilled for all $a \in A$.
There are essentially two different ways to arrive at a $C^\ast$-completion of the algebraic crossed product $C_c(\mathbb{Z}^d, C(\hull), \alpha )$, which are referred to as the full crossed product $C^\ast$-algebra $C(\hull)\rtimes_\theta \mathbb{Z}^d$
and the reduced crossed product $C^\ast$-algebra $C(\hull)\rtimes_{\theta,r} \mathbb{Z}^d$.
A detailed account can be found in \cite[Ch.~7]{Pedersen2018} while a brief, educational overview can be found in \cite[Example~2.2.7]{Khalkhali2013}.

Let $\mathcal{H}$ be a Hilbert space with its bounded operators denoted by $\mathcal{B}(\mathcal{H})$ and unitary operators denoted by $\mathcal{U}(\mathcal{H})$.
A covariant representation $\pi \rtimes \rho$ of $C_c(\mathbb{Z}^d, C(\hull), \alpha )$ is a representation $\pi \colon C(\hull) \to \mathcal{B}(\mathcal{H})$ together with a unitary representation $\rho\colon \mathbb{Z}^d \to \mathcal{U}(\mathcal{H})$ such that
\begin{align}
    (\pi\rtimes \rho) (f \otimes t^{\vec{m}} )  & = \pi(f) \rho(t^{\vec{m}}), \\
    \rho(t^{\vec{m}}) \pi(f) \rho(t^{-\vec{m}})&= \pi(\alpha_{\vec{m}}(f) ) .
\end{align}
$C(\hull)$ itself is a $C^\ast$-algebra with involution given by the complex conjugation and with the uniform norm
\begin{align}
    \| f \|_{\hull} = \sup_{\vec{\varphi} \in \hull}  \| f( \vec{\varphi} ) \|.
\end{align}
We can use this norm to construct the $\ell^n$-norm of $a = \sum_{\vec{m} \in \mathbb{Z}^d} f_{\vec{m}} \otimes t^{\vec{m}} $ as
\begin{align}
 \| a \|_{\ell^n}  =   \left(\sum_{\vec{m} \in \mathbb{Z}^d} \|  f_{\vec{m}} \|_{\hull}^n\right)^{\frac{1}{n}} .
\end{align}
Denote by $\ell^1(\mathbb{Z}^d, C(\hull), \alpha)$ the Banach *-algebra which is obtained through the completion of $C_c(\mathbb{Z}^d, C(\hull), \alpha )$ with respect to the $\ell^1$-norm.
The full crossed product $C^\ast$-algebra $C(\hull)\rtimes_\theta \mathbb{Z}^d$  is then obtained by completing $\ell^1(\mathbb{Z}^d,C(\hull), \alpha)$ with respect to 
\begin{align}
    \| a \| = \sup_{\pi \rtimes \rho} 
    \| (\pi \rtimes \rho)(a) \|_{\mathcal{B}(\mathcal{H})} ,
\end{align}
defined for all $a\in \ell^1(\mathbb{Z}^d,C(\hull), \alpha)$ and with the norm on the right being the operator norm, while the supremum is taken over all covariant representations $\pi \rtimes \rho$ of $C_c(\mathbb{Z}^d, C(\hull), \alpha )$.

Another $C^\ast$-algebra completion with closer ties to the physical description is the reduced crossed product $C^\ast$-algebra since it is built around the physical Hilbert space $\ell^2(\mathbb{Z}^d)$.
For a generic element
$a\in C_c(\mathbb{Z}^d, C(\hull), \alpha )$
given by $a=\sum_{\vec{m} \in \mathbb{Z}^d} f_{\vec{m}} \otimes t^{\vec{m}}$,
we define a family $\lbrace \pi_{\vec{\varphi}}^\rtimes \rbrace_{\vec{\varphi}\in\hull} $
of $\ast$-representations $\pi_{\vec{\varphi}}^\rtimes = \pi_{\vec{\varphi}} \otimes \rho $ by setting
\begin{align}
    \rho(t^{\vec{m}}) &= \hat{T}_{\vec{m}},
    \\ 
    \pi_{\vec{\varphi}}(f_{\vec{m}})&=\sum_{\vec{i} \in \mathbb{Z}^{d}} (\alpha_{-\vec{i}}f_{\vec{m}})(\vec{\varphi})  \ket{\vec{i}}\bra{\vec{i}}
\end{align}
where $\hat{T}_{\vec{m}}$ is the unitary translation operator on $\ell^2(\mathbb{Z}^d)$ with $\hat{T}_{\vec{m}}\ket{\vec{i}}=\ket{\vec{i}+\vec{m}}$ for $\vec{i},\vec{m} \in \mathbb{Z}^d$.
The covariance is easily observed:
\begin{align}
\rho(t^{\vec{m}})\pi_{\vec{\varphi}}(f)\rho(t^{-\vec{m}})
&=\sum_{\vec{i} \in \mathbb{Z}^{d}} (\alpha_{-\vec{i}}f)(\vec{\varphi})  \ket{\vec{i}+\vec{m}}\bra{\vec{i}+\vec{m}}
\notag \\
&=\sum_{\vec{i} \in \mathbb{Z}^{d}} (\alpha_{-\vec{i}} \alpha_{\vec{m}} f)(\vec{\varphi})  \ket{\vec{i}}\bra{\vec{i}}
\notag \\
&=\pi_{\vec{\varphi}}(\alpha_{\vec{m}}f),
\end{align}
for all $f \in C(\hull)$ and $\vec{m} \in \mathbb{Z}^d$.
We can use $\pi_{\vec{\varphi}}^\rtimes$ to formulate the norm
\begin{equation}
    \| a \| = \sup_{\vec{\varphi}\in\hull} 
    \| \pi_{\vec{\varphi}}^\rtimes(a) \|_{\mathcal{B}(\mathcal{H})}.
\end{equation}
The completion of $C_c(\mathbb{Z}^d, C(\hull), \alpha )$ with respect to this norm is the reduced crossed product $C^\ast$-algebra $C(\hull)\rtimes_{\theta,r} \mathbb{Z}^d$.
For the noncommutative torus, it turns out that the two completions discussed in this section give identical $C^\ast$-algebras \cite[Thm.~7.13]{Williams2007}, and we can drop the distinction in the notation from now on.

If the translation action on $\hull$ is ergodic, then $\pi^\rtimes_{\vec{\varphi}}$ is faithful \cite[Prop.~3.8]{Prodan2017}.
This is because $\pi_{\vec{\varphi}}^\rtimes(a)=0$ if an only if $f_{\vec{m}}( \tau_{\vec{n}} \vec{\varphi} )=0$ for all coefficient functions $f_{\vec{m}}$ and translates $\vec{n} \in \mathbb{Z}^d$.
Since the action is ergodic for all $\vec{\varphi}\in \hull$ and the coefficient functions are continuous, one must have $f_{\vec{m}}( \vec{\varphi} )=0$ everywhere.
The faithfulness shows that our algebra does not contain any redundant or unnecessary information about the observables. It is the minimal algebraic structure that describes the essential physical properties of the electronic system: algebraically distinct observables in $C(\hull)\rtimes_{\theta} \mathbb{Z}^d$ will have physically distinct representations on $\mathcal{B}(\mathcal{H})$.

We can think of $C(T^r)$ in terms of the universal $C^\ast$-algebra
\begin{align}
    C(T^r) = \braket{ u_1, \ldots, u_r ~|~ u_i u_j = u_j u_i},
\end{align}
where we represent the generators $u_i$ as the continuous phase factors $u_j(\vec{\varphi})= e^{i \varphi_j }$.
The generators $u_j$ obey the following commutation relation in $C(\hull)\rtimes_{\theta} \mathbb{Z}^d$
\begin{align}
    t_i u_j = \alpha_{\vec{e}_i}(u_j) t_i = e^{-2\pi i \theta_{ji}} u_j t_i
    =  e^{2\pi i (-\theta^T)_{ij}} u_j t_i,
\end{align}
which follows from Eq.~(\ref{eq:crossed_product_multiplication}).
This means if we combine the generators of translations $t_i$ and the generators of continuous functions $u_j$ into a single notation:
\begin{align}
    \vec{\gamma} = (\gamma_1,\ldots, \gamma_{r+d}) = (t_1, \ldots, t_d, u_1, \ldots, u_r),
\end{align}
then we can give an equivalent description of $C(\hull)\rtimes_{\theta} \mathbb{Z}^d$ in terms of the universal $C^\ast$-algebra
\begin{align}
    \mathcal{A}_\theta = C(\hull)\rtimes_{\theta} \mathbb{Z}^d
    = \braket{\gamma_1,\ldots, \gamma_{r+d} ~|~ 
    \gamma_i \gamma_j =  e^{2\pi i \Theta_{ij}}
    \gamma_j \gamma_i},
\end{align}
where $\Theta$ is the $(r+d) \times (r+d)$ matrix
\begin{align}
    \Theta = \begin{pmatrix}
        0 & -\theta^T \\
        \theta & 0 
    \end{pmatrix} .
\end{align}
In conclusion, the observable algebra of spin-$1/2$ electrons on the $\mathbb{Z}^d$ lattice in contact with an ergodic multi-$q$ texture is 
\begin{align}
    \mathcal{A} = M_2(\mathbb{C}) \otimes  ( C(\hull)\rtimes_{\theta} \mathbb{Z}^d ),
\end{align}
and we can extend $\pi_{\vec{\varphi}}$ to $\mathcal{A}$ by setting
\begin{equation}
    \pi_{\vec{\varphi}}(m \otimes a) = m \otimes \pi_{\vec{\varphi}}(a),
\end{equation}
for all $m \in M_2(\mathbb{C})$ and $a \in C(\hull)\rtimes_{\theta} \mathbb{Z}^d $.

\subsection{The canonical form of the tight-binding Hamiltonian}
\label{subsec:canonicalHamiltomian}
% -- identify our tight-binding Hamiltonian as a representation of the crossed product algebra

% Canonical form
To elucidate that the tight-binding Hamiltonian from Eq.~\eqref{eq:tbHamiltonian} incorporating multi-$q$ magnetic order is indeed a representation of a noncommutative torus' algebra element, we rewrite the Hamiltonian into its canonical form.
From a given site $\vec{i} \in \mathbb{Z}^d$, denote by $\vec{d}_1, \ldots, \vec{d}_c \in \mathbb{Z}^d$ the relative position of its nearest neighbors (which we assume to be independent of $\vec{i}$) with $c$ being the coordination number of the lattice.
Further we define $\vec{\varphi} = \vec{\omega}(\vec{x}_{\vec{0}})$.
For the hopping term, one then finds
\begin{align}
H_\mathrm{hop}  &= - \hop \sum_{\braket{\vec{i},\vec{j}} \in \mathbb{Z}^{2d}} \ket{\vec{i}}\bra{\vec{j}}
= - \hop  \sum_{\vec{i} \in \mathbb{Z}^{d}}  \sum_{j=1}^c  \ket{\vec{i}+\mathbf{d}_j}\bra{\vec{i}}
= - \hop  \sum_{\vec{i} \in \mathbb{Z}^{d}}  \sum_{j=1}^c   \hat{T}_{\mathbf{d}_j }\ket{\vec{i}}\bra{\vec{i}} 
\notag\\&
= - \hop   \sum_{j=1}^c  \pi_{\vec{\varphi}} ( t^{\mathbf{d}_j } ). 
\end{align}
The algebra element
\begin{align}
    \Delta = \sum_{j=1}^c   t^{\mathbf{d}_j },
\end{align}
is also referred to as the adjacency operator of the lattice.
The hopping term is now manifestly invariant under translations:  $\hat{T}_{\vec{i}} H_\mathrm{hop}\hat{T}_{\vec{i}}^\dagger = H_\mathrm{hop}$.
The behavior of the exchange term is slightly different. 
Since
\begin{align}
    \vec{n}(\vec{\omega}( \vec{x}_{\vec{i}})) 
    =\vec{n}(\tau_{\vec{i} }( \vec{\varphi} ))
    =\alpha_{-\vec{i}}\vec{n}(\vec{\varphi}) ,
\end{align}
it can be written as 
\begin{align}
H_\mathrm{xc}
	&= \xc\sum_{\vec{i} \in \mathbb{Z}^d} \bsigma \cdot \vec{n}(\vec{\omega}( \vec{x}_{\vec{i}}))   \ket{\vec{i}}\bra{\vec{i}} 
 = \xc\sum_{\vec{i} \in \mathbb{Z}^d} \alpha_{-\vec{i}}(\bsigma \cdot \vec{n})(\vec{\varphi})   \ket{\vec{i}}\bra{\vec{i}}
 \notag \\
&= \xc ~\pi_{\vec{\varphi}} ( \bsigma \cdot \vec{n} ).
\end{align}
Combined, these results show that the Hamiltonian  $H=H_\mathrm{hop} + H_\mathrm{xc}$ is given by the covariant representation $H= \pi_{\vec{\varphi}} (h)$
with
\begin{align}
    h = -\hop~\Delta + \xc~\bsigma \cdot \vec{n}  ,
    \label{eq:nct_hamiltonian}
\end{align}
which is an element of $M_2(\mathbb{C})\otimes ( C(\hull)\rtimes_{\theta} \mathbb{Z}^d)$.

\subsection{Traces on the noncommutative torus and Birkhoff's ergodic theorem}
\label{subsec:ergodicity}

While it is intuitively clear what we mean by a trace on $\mathcal{B}(\mathcal{H})$, we have to do a little bit of work to unearth the same concept on the algebraic level of the noncommutative torus.
As a starting point, there is a canonical trace on $C(\hull)$ given by
\begin{align}
    \tau_{C(\hull)}(f) = \frac{1}{|\hull|} \int_{\hull}\dd \vec{\varphi} ~ f( \vec{\varphi}),
\end{align}
with the useful property of being invariant under the $\mathbb{Z}^d$-automorphisms $\alpha$: 
\begin{equation}
    \tau_{C(\hull)}(\alpha_{\vec{m}}f) = \tau_{C(\hull)}(f), ~ \forall  \vec{m}\in \mathbb{Z}^d .
\end{equation}
On the other hand, there is a unique trace on the group algebra $\mathbb{C}\mathbb{Z}^d$ given by
\begin{align}
     \tau_{\mathbb{C}\mathbb{Z}^d}\left( \sum_{\vec{m}\in\mathbb{Z}^d} \gamma_{\vec{m}} t^{\vec{m}}\right) = \gamma_0 .
\end{align}
Combined, their composition can be used to define a trace $\mathcal{T}$ on the observable algebra $\mathcal{A}$  by declaring 
\begin{align}
   \mathcal{T}\left( \sum_{\vec{m} \in \mathbb{Z}^d} f_{\vec{m}} \otimes t^{\vec{m}} \right) = \tau_{C(\hull)}(\tr~f_0) ,
\end{align}
where $\tr$ is the matrix trace of $M_2(\mathbb{C})$.

% -- ergodicity and Birkhoff's theorem

The physical relevance of the trace $\mathcal{T}$ is founded in the ergodic properties of the translation action on $\hull$~\cite{Prodan2017}.
Let $\Pi_V$ be the projector onto a finite cube of volume $V$ centered around the origin.
Using the covariance property of the $\ast$-representation $\pi_{\vec{\varphi}}$, we then can write the trace per unit volume 
in terms of the summation
\begin{align}
   \mathcal{T}_V(a)= \frac{1}{|V|} \sum_{\vec{m} \in \mathbb{Z}^d} \tr~ \bra{\vec{m}} \Pi_V^\dagger \pi_{\vec{\varphi}}(a) \Pi_V \ket{\vec{m}}
   &= \frac{1}{|V|} \sum_{\vec{m} \in V} \tr~ \bra{0} \hat{T}_{\vec{m}}^\dagger \pi_{\vec{\varphi}}(a) \hat{T}_{\vec{m}}\ket{0}
   \\
   &= \frac{1}{|V|} \sum_{\vec{m} \in V} \tr~ \bra{0} \pi_{ \tau_{-\vec{m}}\vec{\varphi}}(a) \ket{0}.
\end{align}
By our assumption, $\tau\colon T^r \to T^r$ is ergodic. We then have a measure-preserving ergodic system $(T^r, \mathscr{B}, \mu, \tau)$, where $\mathscr{B}$ is the Borel $\sigma$-algebra of $T^r$, $\tau$ are the irrational rotations acting on $T^r$ and $\mu$ is the Lebesgue measure on $T^r$, invariant under $\tau$.
In fact, $\tau$ is uniquely ergodic in the sense that the Lebesgue measure is the only $\tau$-invariant measure on $T^r$ \cite[Def. 4.1.7.]{Katok1995}.
Uniquely ergodic systems fulfill a stronger version of Birkhoff's ergodic theorem \cite[Prop. 4.1.13.]{Katok1995} such that
\begin{align}
    \lim_{|V| \to \infty} \frac{1}{|V|} \sum_{\vec{m} \in V} \tr~ \bra{0} \pi_{ \tau_{-\vec{m}}\vec{\varphi}}(a) \ket{0}
    = 
    \frac{1}{(2\pi)^{r}} \int_{T^r}\dd \vec{\varphi} ~ \tr~ \bra{0} \pi_{ \vec{\varphi}}(a) \ket{0} = \mathcal{T}(a),
\end{align}
converges uniformly for all $\vec{\varphi} \in T^r$ and is independent of $\vec{\varphi}$.
In summary, we thus have
\begin{align}
    \lim_{|V| \to \infty} \mathcal{T}_V(a) = \mathcal{T}(a).
\end{align}
The trace per unit volume is perhaps the more natural trace to use and has a clear physical interpretation within the relevant physical Hilbert space.
This result, therefore, shows that this trace is identical to its purely algebraic counterpart in the thermodynamic limit and is important to establish the physical significance of the algebraic formulation.

\subsection{\texorpdfstring{$K$}{K}-theory of the noncommutative torus}
\label{subsec:k_theory}

% -- Short primer to K theory
Operator $K$-theory is the noncommutative analog of topological $K$-theory classifying isomorphism classes of vector bundles. While the latter is only equipped to investigate projections of the $C^\ast$-algebra of matrix-valued continuous functions on locally compact Hausdorff spaces, operator $K$-theory can also classify projections in more difficult, noncommutative $C^\ast$-algebras, such as the noncommutative torus.
The relevance to physical properties is directly inferred from this: the observable $C^*$-algebra describing a physical system contains all spectral (Fermi) projections, which can thus be labeled by topologically invariant numbers, the so-called Chern numbers. They are closely related to further physical quantities, e.g., transport behavior.
The following overview about $K$-theory summarizes the relevant concepts for the context of this work and is based on the textbook account of \cite{Rordam2000}.

Projections are one of the key subjects of $K$-theory.
A projection in a $C^\ast$-algebra $A$ is a self-adjoint, idempotent element $p$, i.e. $p=p^\ast=p^2$. 
There are several ways to define equivalences of $C^\ast$-algebra elements. 
From topology we are familiar with \emph{homotopy}, i.e., two elements are $a,b\in A$ are \emph{homotopic} $a\sim_h b$, if there exists a continuous map $v:[0,1]\to A, t\mapsto v(t)$ with $v(0)=a$ and $v(1)=b$.
For the equivalence of projections, the image of this map needs to be a projection at every point.
Two additional concepts for equivalence of projections are given by the \emph{Murray-von Neumann equivalence} $p\sim q$ if there exists $v\in A$ with $vv^\ast=p$ and $v^\ast v=q$, and the \emph{unitary equivalence} $p\sim_u q$, if there exists a unitary element $u$ in the unitarization $A^+$ with $q=upu^\ast$.

Passing to matrix algebras $M_n(\mathbb{C})\otimes A$ with arbitrary but finite dimension $n\in\mathbb{N}$ one can coincide these notions of equivalence of projections from $A$. 
Let now $\mathcal{P}_\infty(A)$ be the limit of the union over all projections in all of these finite-dimensional matrix algebras. 
On this set, one can define the equivalence relation $p \sim_0 q$ for projections $p \in M_n(\mathbb{C})\otimes A$ and $q \in M_m(\mathbb{C})\otimes A$ if there exists $v \in  M_{m,n}(\mathbb{C})\otimes A$ such that $p=v^\ast v$ and $q=vv^\ast$.
With the direct sum on $\mathcal{P}_\infty(A)$ given by
\begin{equation}
    p\oplus q = \text{diag}(p,q)=\begin{pmatrix}
        p & 0 \\ 0 & q
    \end{pmatrix},
\end{equation}
the set of equivalence classes $\mathcal{P}_\infty(A)/\sim_0$ is an abelian semi-group.
The notion of an inverse element which is crucial in the definition of a group is missing as of now.

If the $C^\ast$-algebra $A$ is unital, we can straightforwardly generate the Grothendieck group from this semi-group to define $K_0(A)$.
One can view this process as similar to the way the integers are constructed out of natural numbers by ``inventing'' negative numbers.
% Two homotopic projections in $M_n(\mathbb{C})\otimes A$ are then in the same equivalence class in $K_0(A)$, and 
$K_0(A)$ is the only group, up to a unique group homomorphism, with the property that 
any two homotopic projections in $M_n(\mathbb{C})\otimes A$ correspond to the same well-defined group element in a way which is consistent with addition and the group's neutral element \cite[Prop.~3.1.8]{Rordam2000}.
If $A$ is not unital, one defines $K_0(A)$ as the kernel of the homomorphism $K_0(A^+)\to K_0(\mathbb{C})$, where $ A^+\cong A\oplus \mathbb{C}$ is the unitarization of $A$.

% -- K theory of the torus
For the observable algebra of spin-$1/2$ electrons $\mathcal{A}=M_2(\mathbb{C})\otimes\mathcal{A}_\theta$ with the noncommutative torus $\mathcal{A}_\theta=C(\hull)\rtimes_\theta \mathbb{Z}^d$ of dimension $r+d$ one finds \cite[Prop.~4.2.4]{Prodan2017}
\begin{equation}
    K_0(\mathcal{A})=K_0(\mathcal{A}_\theta)=\mathbb{Z}^{2^{r+d-1}},
\end{equation}
independent on the matrix $\theta$. For more on the $K_0$-group for higher dimensional noncommutative tori, we refer to \cite{Rieffel1988}. This means, that there are $2^{r+d-1}$ generators $[e_J]$, which can be uniquely labeled by the subsets of indices $J\subseteq\{t_1, \ldots, t_d, u_1, \ldots, u_r\}$ of even cardinality.
The equivalence class of any projection from $P_\infty(\mathcal{A})$ can be uniquely decomposed into these generators with integer coefficients $n_J$:
\begin{equation}
    [p]_0 = \sum_{\substack{J\subseteq\{t_1, \ldots, t_d, u_1, \ldots, u_r\}\\ |J|\ \text{even}}} n_J [e_J]_0.
\end{equation}
If $p$ is homotopically deformed, it stays inside its $K_0$ class, and the integer labels $n_J$ do not change.
They are the complete set of topological invariants associated with the projection $p$.
For a Fermi projection of a physical observable algebra, they label the energy gap of the spectrum in which the Fermi energy is located.

\subsection{The noncommutative \texorpdfstring{$n$}{n}-th Chern number}
\label{subsec:chern_numbers}

% -- cyclic cocycles and characters of cycles
% a short primer on the properties of cyclic cocycles and their construction
To access all the $K_0$ labels of a specific projection $p$ we can pair its corresponding $K_0$ equivalence class $[p]_0$ with a so-called \emph{cyclic cocycle} \cite{Connes1994,Gracia2000,Khalkhali2013}. 
They generalize the concept of a bounded trace by defining group morphisms from the $K_0$ group to $\mathbb{C}$.
Cyclic $n$-cocycles $\eta$ on an algebra $A$ are multi-linear maps in $\mathrm{Hom}_{\mathbb{C}}(A^{\otimes(n+1)},\mathbb{C})$ which fulfil the additional conditions of being cyclic, $\lambda \eta = \eta$, and closed under the Hochschild boundary map, $b\eta=0$, where
\begin{align}
    \lambda \eta(a_0,\dots,a_n)&=(-1)^n \eta(a_n,a_0,\dots,a_{n-1})\quad \mathrm{and} \\
    b \eta(a_0,\dots,a_{n+1}) &= \sum_{j=0}^n (-1)^j \eta(a_0,\dots,a_ja_{j+1},\dots,a_{n+1}) + (-1)^{n+1}\eta(a_{n+1}a_0,\dots,a_n),
\end{align}
for $a_0,\dots,a_{n+1}\in A$.
They can also more conveniently be described as the characters of $n$-cycles $(\Omega,d,\int)$ over the algebra $A$, which consist of a graded, differential algebra $(\Omega,d)$, with $\Omega^0\cong A$, and a closed, graded trace $\int$. 
This way, one obtains a cyclic $n$-cocycle of the form \cite[III.1.$\alpha$. Prop. 4]{Connes1994}:
% Here, I omitted the isomorphism A -> Omega^0
\begin{equation}
    \eta(a_0,\dots,a_n) = \int a_0 da_1\dots da_n.
\end{equation}
In particular, if we have a linear functional with the trace property, such as the trace of the noncommutative torus $\mathcal{T}$, as well as $n$ mutually commuting derivations $\partial_1,\dots,\partial_n: A\rightarrow A$ such that $\mathcal{T}(\partial_j(a))=0$ for any $a\in A$ and $j\in\{1,\dots,n\}$, then a cyclic $n$-cocycle is given by \cite[Example~3.6.6]{Khalkhali2013}
\begin{equation}
    \eta(a_0,\dots,a_n) := \sum_{\sigma\in S_n} \mathrm{sgn}(\sigma)\ \mathcal{T}(a_0 \partial_{\sigma(1)}a_1\dots \partial_{\sigma(n)}a_n),
\end{equation}
where $S_n$ denotes the permutation group of $n$ elements.

% -- differential calculus
% Here, we need to introduce the torus action, the derivations, and the dense smooth subalgebra
In the case of the noncommutative torus, we can define derivations associated with the real space and the phase space.
For this, we consider an action of the Lie group $T^{r+d}$ on the $C^\ast$-algebra $\mathcal{A}_\theta=C(\hull)\rtimes_\theta \mathbb{Z}^d$. Let the action $\rho: T^{r+d} \to \textrm{Aut}(\mathcal{A}_\theta)$ act on the generators and their coefficients the following way
\begin{align}
    \rho_{\vec{\lambda}}(f)(\vec{\varphi}) &= f(\vec{\varphi}+ \vec{\xi}),\\
    \rho_{\vec{\lambda}}(t_i) &= e^{-ik_i} t_i,\quad i=1,...,d,
\end{align}
with $\vec{\lambda}=(\vec{\xi},\vec{k})\in [0,2\pi]^{r+d}$ and $f\in C(\hull)$.
This can be extended to a point-wise norm continuous group of $\ast$-automorphisms on the noncommutative torus \cite[Prop.~3.10.]{Prodan2017}.

Elements of the algebra for which the automorphisms $\rho_\lambda$ are $n$-times differentiable for $\lambda$ are called $n$-times differentiable as well.
They form a linear subspace dense in $\mathcal{A}_\theta$.
The dense subalgebra $\mathscr{A}_\theta$ of smooth, i.e., infinitely differentiable, elements is a Fr\'echet pre-$C^\ast$-algebra \cite[Prop.~3.45]{Gracia2000}.
Since its $C^*$-completion is the full noncommutative torus, the inclusion $i:\mathscr{A}_\theta\to\mathcal{A}_\theta$ induces an isomorphism of $K_0$-groups $K_0(i): K_0(\mathscr{A}_\theta)\to K_0(\mathcal{A}_\theta)$ \cite[Thm.~3.44]{Gracia2000}. 
This means the smooth noncommutative torus $\mathscr{A}_\theta$ has the same $K_0$ group as the full noncommutative torus $C^\ast$-algebra $\mathcal{A}_\theta$ itself.

Further, the pre-$C^\ast$-property implies that the algebra is stable under holomorphic functional calculus, which is crucial for our purpose. 
It guarantees to us that any Fermi projection $p_F$ of the Hamiltonian $h$ belongs to the smooth noncommutative torus, provided the Fermi energy $E_F$ lies within a gap of the Hamiltonians spectrum $\sigma(h)$. 
Let $E_F\notin \sigma(h)$ and $\Gamma_F$ be the contour in $\mathbb{C}$ which encircles $\sigma(h)\cap (-\infty,E_F)$ and does not intersect $\sigma(h)$. 
Then the Fermi projection $p_F$ may be defined by the Riesz projector
\begin{equation}
    p_F = \frac{1}{2\pi i} \oint_{\Gamma_F} (z-h)^{-1} \dd{z}.
    \label{eq:Riesz_projector}
\end{equation}
The derivations are obtained from differentiating the torus action are unbounded, closed $\ast$-derivations of the form % their representation
\begin{equation}
    \partial_j^u a =\partial_j^u \sum_{\vec{n}\in \mathbb{Z}^d} a_{\vec{n}} \otimes t_{\vec{n}} = \sum_{\vec{n}\in \mathbb{Z}^d}  (\partial_{\varphi_j} a_{\vec{n}}) \otimes t_{\vec{n}}
\end{equation}
and
\begin{equation}
    \partial_j^t a =\partial_j^t \sum_{\vec{n}\in \mathbb{Z}^d} a_{\vec{n}} \otimes t_{\vec{n}} = -i \sum_{\vec{n}\in \mathbb{Z}^d} n_j a_{\vec{n}} \otimes t_{\vec{n}}.
\end{equation}
They mutually commute and the trace of the derivation of any algebra element is zero.
% -- Chern numbers
Putting this all together with the proper prefactor and the internal spin degrees of freedom, we obtain the following Chern number from pairing the Chern character with a projection $p$ of the observable algebra $\mathcal{A}=M_2(\mathbb{C})\otimes \mathcal{A}_\theta$ \cite{Prodan2013b}:
\begin{align}
    Ch_J([p]_0) = \frac{(2\pi i )^{ | J| /2 }}{(| J| /2)!}  \sum_{\sigma \in S_{|J|} } (-1)^\sigma \mathcal{T}\left( p \prod_{j \in J} \partial_{\sigma_j} p \right),
    \label{eq:Chernnumber}
\end{align}
with $J\subseteq \{t_1, \ldots, t_d, u_1, \ldots, u_r\}$ and $|J|$ even. For the particular case of $J=\emptyset$, one has $ Ch_\emptyset([p]_0) = \mathcal{T}(p)$.
Since cyclic cocycles on an algebra induce group homomorphisms from its $K_0$-group to $\mathbb{C}$, we can evaluate the Chern number of each projection's equivalence class by its linear decomposition into the $K_0$-groups generators and the evaluation of the Chern characters of the generators. For the projection class
\begin{equation}
    [p]_0 = \sum_{\substack{I\subseteq\{t_1, \ldots, t_d, u_1, \ldots, u_r\}\\ |I|\ \text{even}}} n_I [e_I]_0,
\end{equation}
we obtain the Chern number
\begin{equation}
    Ch_J([p]_0) = \sum_{\substack{I\subseteq\{t_1, \ldots, t_d, u_1, \ldots, u_r\}\\ |I|\ \text{even}}} n_I Ch_J([e_I]_0).
\end{equation}
The value of the Chern numbers on the generators of $K_0$ can be determined explicitly, and one finds \cite{Prodan2016, Liu2022}
 ${\rm Ch}_{J}([e_I]_0)=1$ if $J=I$,  ${\rm Ch}_{J}([e_I]_0)=0$ if $J \not\subseteq I$ and ${\rm Ch}_{J}([e_I]_0) = \mathrm{Pf}( \Theta_{I\setminus J})$ otherwise.
The operation $\mathrm{Pf}$ denotes the Pfaffian and $\Theta_{I\setminus J}$ is the representation of $\Theta$ in the reduced index set $I\setminus J$.
Evaluating the Chern numbers enables us to extract the corresponding $n_I$'s.
For example, for the $3q$ skyrmion lattice with $\mathcal{A}_\theta=C(T^2)\rtimes_\theta \mathbb{Z}^2$ and $K_0(\mathcal{A}_\theta)=\mathbb{Z}^8$, we can consider
\begin{align}
    \theta = \vartheta \begin{pmatrix}
        1 & 0 \\
        0 & 1
    \end{pmatrix},
\end{align}
and find
\begin{align}
    Ch_{\emptyset} &= n_{\emptyset} - \vartheta n_{\lbrace t_1, u_1\rbrace} - \vartheta n_{\lbrace t_2, u_2 \rbrace} - \vartheta^2 n_{\lbrace t_1, t_2, u_1, u_2 \rbrace} \label{eq:Chernnumbers1}
\\
Ch_{\lbrace t_1,t_2 \rbrace} &= n_{\lbrace t_1,t_2\rbrace} \label{eq:Chernnumbers2}
\\
Ch_{\lbrace t_1, u_1 \rbrace} &= n_{\lbrace t_1 ,u_1\rbrace} - \vartheta n_{\lbrace t_2, u_2 \rbrace} - \vartheta n_{\lbrace t_1 t_2 u_1 u_2 \rbrace} \label{eq:Chernnumbers3}
\\
Ch_{\lbrace t_1, u_2 \rbrace}&= n_{\lbrace t_1,u_2\rbrace} \label{eq:Chernnumbers4}
\\
Ch_{\lbrace t_2, u_1 \rbrace} &= n_{\lbrace t_2,u_1\rbrace} \label{eq:Chernnumbers5}
\\
Ch_{\lbrace t_2 ,u_2 \rbrace} &=
  n_{\lbrace t_2 ,u_2\rbrace} -\vartheta n_{\lbrace t_1, u_1 \rbrace} - \vartheta n_{\lbrace t_1 t_2 u_1 u_2 \rbrace} \label{eq:Chernnumbers6}
\\
Ch_{\lbrace u_1 , u_2 \rbrace} &= n_{\lbrace u_1 , u_2 \rbrace} \label{eq:Chernnumbers7}
\\
Ch_{\lbrace t_1, t_2, u_1, u_2  \rbrace} &= n_{\lbrace t_1, t_2, u_1, u_2 \rbrace}
\label{eq:Chernnumbers8}
\end{align}
Moreover, the linear system of equations can be inverted to provide a mapping from the Chern numbers onto the integer invariants:
\begin{align}
       n_{\emptyset} &= Ch_{\emptyset} + \frac{-\vartheta (Ch_{\lbrace t_1, u_1\rbrace} + Ch_{\lbrace t_2, u_2 \rbrace}) + \vartheta^2(\vartheta-3)  Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace} }{\vartheta-1} \label{eq:Chernlabels1}
\\
n_{\lbrace t_1,t_2\rbrace} &= Ch_{\lbrace t_1,t_2 \rbrace} \label{eq:Chernlabels2}
\\
n_{\lbrace t_1, u_1 \rbrace} &=  \frac{Ch_{\lbrace t_1, u_1\rbrace} + \vartheta Ch_{\lbrace t_2, u_2 \rbrace} + \vartheta(\vartheta+1)  Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace} }{1-\vartheta^2} \label{eq:Chernlabels3}
\\
n_{\lbrace t_1,u_2\rbrace} &=  Ch_{\lbrace t_1, u_2 \rbrace} \label{eq:Chernlabels4}
\\
n_{\lbrace t_2,u_1\rbrace}  &=  Ch_{\lbrace t_2, u_1 \rbrace} \label{eq:Chernlabels5}
\\
n_{\lbrace t_2 ,u_2 \rbrace} &=
\frac{Ch_{\lbrace t_2, u_2\rbrace} + \vartheta Ch_{\lbrace t_1, u_1 \rbrace} + \vartheta(\vartheta+1)  Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace} }{1-\vartheta^2} \label{eq:Chernlabels6}
\\
n_{\lbrace u_1 , u_2 \rbrace} &=  Ch_{\lbrace u_1 , u_2 \rbrace} \label{eq:Chernlabels7}
\\
 n_{\lbrace t_1, t_2, u_1, u_2 \rbrace} &=  Ch_{\lbrace t_1, t_2, u_1, u_2  \rbrace} .
\label{eq:Chernlabels8}
\end{align}

\subsection{Physical interpretation of Chern numbers}

The Chern number with the most well-known connection to physics is $Ch_{\lbrace t_1 t_2 \rbrace}$, describing the intrinsic contributions to the anomalous Hall effect:
\begin{align}
    \sigma_{[xy]} = \frac{e}{h}  Ch_{\lbrace t_1 t_2 \rbrace}
\end{align}
The $K$-theory analysis shows that for the skyrmion multi-$q$ texture considered in this work, $Ch_{\lbrace t_1 t_2 \rbrace} = n_{\lbrace t_1 t_2 \rbrace}$ is quantized to integer values as expected \cite{Hamamoto2015}.
We argue, that $Ch_{\lbrace u_1 u_2 \rbrace}$ describes the real-space winding number of the spin of the electronic states, and our numerical Chern number computation reveals, that a single band at the van-Hove singularity carries the whole contribution to it.
Aside from $Ch_{\lbrace t_1 t_2 \rbrace}$ and $Ch_{\lbrace u_1 u_2 \rbrace}$, the remaining Chern numbers could be potentially relevant in a physics context. 

For example, the integrated density of states represents the total number of electrons per unit volume (the charge carrier density), and according to the previous analysis, it obeys the polynomial equation
\begin{align}
     \mathrm{IDS} = Ch_{\emptyset} &= n_{\emptyset} - \vartheta n_{\lbrace t_1, u_1\rbrace} - \vartheta n_{\lbrace t_2, u_2 \rbrace} - \vartheta^2 n_{\lbrace t_1, t_2, u_1, u_2 \rbrace},
     \label{eq:ids_constraint}
\end{align}
where all coefficients $n_J$ are integers.
The IDS is typically fixed by the chemistry of the respective material.
Assume two insulators with different IDS harbor the same topological state in the sense that the Fermi projections belong to the same $K$-theory class.
Then, due to the different chemistry of the materials, $\vartheta$ must change in order to fulfill the constraints imposed by the polynomial equation above.
Imagine the IDS could be tuned by the application of a gate voltage $\phi$. 
If the system remains insulating, the only way to accommodate the change in IDS is a variation of $\vartheta$, i.e.,
\begin{align}
   \partial_\phi \vartheta     = -  
   \frac{\partial_\phi\mathrm{IDS}}{n_{\lbrace t_1, u_1\rbrace} +  n_{\lbrace t_2, u_2 \rbrace} + 2 \vartheta n_{\lbrace t_1, t_2, u_1, u_2 \rbrace}}.
\end{align}
This means that the topological states enable a magnetoelectric behavior, controlled by the mixed space Chern numbers.
The mixed space Chern numbers are further related to the existence of mixed space Berry curvature that also has transport manifestations such as the chiral Hall effect \cite{Lux2020,Kipp2021} and orbital magnetization \cite{Lux2018}.

Lastly, we want to mention that the Chern numbers can play an important role in shaping the dynamical properties of topological magnetic materials, as shown in \cite{Yang2011}.
In essence, an adiabatic time-dependent modulation of the magnetic order can induce spin and charge currents of topological origin.

\section{The approximating algebra for computation}
\label{sec:computation}

The tight-binding Hamiltonian acts on the infinite-dimensional Hilbert space $\mathbb{C}^2\otimes \ell^2(\mathbb{Z}^d)$ and is therefore impossible to implement explicitly for computation. 
The conventional solution to this problem is to impose periodic boundary conditions.
Mathematically, this boils down to a description of the group $\mathbb{Z}$ as a direct limit of normal subgroups, for example,
\begin{align}
    \mathbb{Z} = p^0 \mathbb{Z} \triangleright p^1 \mathbb{Z} \triangleright p^2 \mathbb{Z} \triangleright  \ldots,
\end{align}
where $p$ is a natural number greater than $1$.
The respective quotients $\mathbb{Z} / p^k \mathbb{Z} = \mathbb{Z}_{p^k}$ are the integers modulo $p^k$ and are finite dimensional.
Their direct limit is in general much larger than $\mathbb{Z}$, but the quotient morphisms $\mathbb{Z}\to\mathbb{Z}_{p^k}$ together with the universal property of the limit imply the existence of an injective group morphism onto a dense subspace of the direct limit ~\cite[Chap.~4.1]{Lux2023}.
One can then be sure that model Hamiltonians taken from the group $C^\ast$-algebra of $\mathbb{Z}^d$ can be described in terms of a sequence of finite-dimensional, approximate Hamiltonians with periodic boundary conditions whose resolvent, density of states, etc., converges to the true bulk limit as $k\to \infty$~\cite[Chap.~4.3]{Lux2023}.

If the $\theta$ matrix contains irrational values, it seems impossible at first to use the prescription of converging periodic boundary conditions.
Still, we can take a sequence of rational approximations to $\theta$ such that the convergence can be equally ensured as $k\to\infty$ \cite[Ch. 5]{Prodan2017}. 
This can be done, for example, by using an expansion of $\theta$ in terms of continued fractions~\cite{Landi2001}.
In that case, the lattice group action does not act ergodically on the texture and the trace does not exactly correspond to the integral over the full phase space. 
Still, it gives a good numerical approximation for increasingly irrational approximations of $\theta$ where bigger and bigger periodic supercells sample the phase space sufficiently well. 
The algebra and differential calculus representation must be modified accordingly to accommodate these finite approximations. 
This will be discussed in the subsequent sections.

% -- Semiclassical limit for supercell calculations

\subsection{Finite-volume approximating algebra}
\label{subsec:periodic_boundary}

We consider the periodic approximating algebras in the form of \cite[Ch. 4.4]{Prodan2017}
\begin{align}
    \mathcal{A}_\theta^N
    = \braket{\gamma_1,\ldots, \gamma_{r+d} ~|~ 
    \gamma_i \gamma_j =  e^{2\pi i \Theta_{ij}}
    \gamma_j \gamma_i,~ \gamma_i^{N_i}=1},
\end{align}
where $N_i \in \mathbb{N}$.
Consistency among the relations can only be achieved for certain quantized values of the flux matrix with respect to the system sizes $N_i$.
This is because
\begin{align}
   \gamma_i = \gamma_j^{N_j} \gamma_i =  e^{2\pi i \Theta_{ji} N_j} \gamma_i  \gamma_j^{N_j}  = e^{2\pi i \Theta_{ji} N_j} \gamma_i .
\end{align}
Taking the block structure of the flux matrix into account, the entries of the flux matrix need to fulfill the quantization condition
\begin{align}
   [ \Theta_{ji} N_j]=0 \Leftrightarrow [\theta_{ij} N_j] = 0,
\end{align}
for $i=1,\ldots,r$ and $j =1,\ldots,d$.
If the $\theta_{ij}$ coefficients are rational, they can respectively be expressed with co-prime integers $a_{ij}, b_{ij}\in\mathbb{N}$, such that $\theta_{ij}=\frac{a_{ij}}{b_{ij}}$. We can then always find a system size with $N_1,\dots, N_d$ to meet the above requirements.

For each real space dimension, $j=1,\dots,d$, there exists an $N_j$ such that for each $i=1,\dots,r$ there is an $m_{ij}\in\mathbb{N}$ with $m_{ij} b_{ij}=N_j$. The smallest such $N_j$ is the least common multiple of the $b_{ij}$, $i=1,\dots,r$. 
Then we have $N_j\theta_{ij}=m_{ij} a_{ij} \in \mathbb{N}$, in other words, $[\theta_{ij} N_j] = 0$.

For simplicity, we will only consider the case $N_j = N = 2L+1$ for all $j =1,\ldots,d$ with $L\in\mathbb{N}$.
Let $V_N$ denote the cube of length $N=2L+1$ centered at the origin.
The canonical Hilbert space is then $\ell^2(V_N)$ and we have a field $\{\hat{\pi}^\rtimes_{\vec{\varphi}}\}_{\vec{\varphi}\in \hull}$ of covariant $\ast$-representations
$\hat{\pi}^\rtimes_{\vec{\varphi}} \colon\mathcal{A}_\theta^N \to \mathcal{B}(\ell^2(V_N)) $ with $\hat{\pi}^\rtimes_{\vec{\varphi}} = \hat{\pi}_{\vec{\varphi}} \rtimes \hat{\rho}$
given by
\begin{align}
     \hat{\rho}(t_i) &=  \hat{T}_i
     \\
     \hat{\pi}_{\vec{\varphi}}(f) &
     =\sum_{\vec{m} \in V_N} (\alpha_{-\vec{m}}f)(\vec{\varphi}) \ket{\vec{m}}\bra{\vec{m}}
\end{align}
for all translation generators $t_i$ and all $f \in C(\hull)$.
$\hat{T}_i$ is again the translation operator, but this time on the finite lattice with periodic boundary conditions.
Having the super-cell balanced, i.e. $\vec{m}\in V_n$ implying $-\vec{m}\in V_N$, makes $\hat{\pi}^\rtimes$ a $\ast$-homomorphism.
$\hat{\pi}^\rtimes_{\vec{\varphi}}$ provides us with a finite-dimensional matrix, suitable for our numerical computations.

\subsection{Approximate differential calculus}
\label{subsec:approx_calculus}

% -- representation of *-derivations
The $u$-derivations are straightforward to compute since they can be obtained directly from the partial derivatives as
\begin{equation}
    \pi_{\vec{\varphi}}^\rtimes(\partial_j^u a) = \sum_{\vec{n}\in\mathbb{Z}^d} \sum_{\vec{m}\in\mathbb{Z}^d} (\partial_{\varphi_j} a_{\vec{n}}(\tau_{-\vec{m}} \vec{\varphi})) \ket{\vec{m}}\bra{\vec{m}} \hat{T}_{\vec{n}}
    = \partial_{\varphi_j}  \pi_{\vec{\varphi}}^\rtimes(a)
\end{equation}
for $a \in \mathscr{A}_\theta$, which we implement numerically using a finite-difference quotient. This recipe works in exactly the same way for the finite-volume approximating algebras $\mathcal{A}_\theta^N$ and their representations $\hat{\pi}^\rtimes_{\vec{\varphi}}$.

\noindent The representations of the $t$-derivations for $\mathscr{A}_\theta$ are computed from the commutator with the position operator as 
\begin{equation}
    \pi_{\vec{\varphi}}^\rtimes(\partial_j^t a) = i[\pi^\rtimes_{\vec{\varphi}}(a),\hat{x}_j] .
\end{equation}
where  $\hat{x}_j$ is the position operator acting on $\ell^2(\mathbb{Z}^d)$, i.e., $ \hat{\vec{x}}$ has the spectral decomposition
\begin{align}
    \hat{\vec{x}} = \sum_{\vec{m}\in \mathbb{Z}^d} \vec{m} \ket{\vec{m}}\bra{\vec{m}} .
\end{align}
This requires some care in carrying it over to the finite approximations. 
For $a\in\mathcal{A}_\theta^N$ one finds \cite[Prop 4.26]{Prodan2017} that
\begin{equation}
    \hat{\pi}^\rtimes_{\vec{\varphi}}(\partial_j^t a) = -i\sum_{\lambda^{2L+1}=1} c_\lambda\ \lambda^{X_j} \hat{\pi}^\rtimes_{\vec{\varphi}}(a)\lambda^{-X_j},
\end{equation}
where
\begin{equation}
    c_\lambda = \begin{cases}
\frac{\lambda^{L+1}}{1-\lambda}, & \text{if}\ \lambda\neq 1 \\
 0, & \text{if}\ \lambda=1
\end{cases}.
\end{equation}
The result follows from the identity
\begin{align}
    n = \sum_{\lambda^{2L+1}=1} c_\lambda\ \lambda^n \quad \text{for} \quad n\in \{-L,\dots,L\} ,
\end{align}
which is the discrete Fourier transformation (DFT) of the sequence of $2L+1$ complex numbers $c_{-L},\dots,c_L$ onto the sequence $-L,\dots,L$.

% -- finite trace
The last missing component is now the appropriate trace for the finite-volume approximating observable algebra $\mathcal{A}^N=M_2(\mathbb{C})\otimes\mathcal{A}_\theta^N$. It is given in analogy to the trace of the noncommutative torus by \cite[Prop 4.26]{Prodan2017}
\begin{equation}
    \hat{\mathcal{T}}(a) = \frac{1}{(2\pi)^{r}} \int_{T^r}\dd \vec{\varphi} ~ \tr~ \bra{0} \hat{\pi}^\rtimes_{ \vec{\varphi}}(a) \ket{0}.
\end{equation}
Since the action on the finite-volume approximation algebra is not ergodic, we cannot use Birkhoff's ergodic theorem again to obtain the trace per unit volume. However, $\hull$ is still invariant under the action, which implies
\begin{equation}
    \hat{\mathcal{T}}(a) = \frac{1}{(2\pi)^{r}} \int_{T^r}\dd \vec{\varphi} ~  \frac{1}{|V_N|} \sum_{\vec{m} \in V_N} ~ \tr~ \bra{\vec{m}} \hat{\pi}^\rtimes_{ \vec{\varphi}}(a) \ket{\vec{m}}.
\end{equation}
For our numerical evaluation, we omit the phase space average and merely compute the finite trace per unit volume
\begin{equation}
    \hat{\mathcal{T}}^{\vec{\varphi}}_{V_N}(a)= \frac{1}{|V_N|} \sum_{\vec{m} \in V_N} \tr~ \bra{\vec{m}} \hat{\pi}^\rtimes_{\vec{\varphi}}(a) \ket{\vec{m}}
    \label{eq:finite_trace}
\end{equation}
for one fixed phase space origin $\vec{\varphi}$. 
In the limit of $N\to \infty$ ergodicity is restored and \eqref{eq:finite_trace} converges to the trace in the non-commutative torus.
The consequences of this approximation are discussed in section \ref{sec:results}. 
We argue that the finite trace per unit volume is physically motivated, as long as there is no physical averaging mechanism.

\subsection{The approximate \texorpdfstring{$n$}{n}-th Chern number}
% -- projection
In order to compute Chern numbers we first need to determine the representation of the Fermi projection $p_F\in\mathcal{A}^N$ as defined in Eq.~\eqref{eq:Riesz_projector}.
Since the representations $\hat{\pi}^\rtimes_{ \vec{\varphi}}$ are homomorphisms they commute with the functional calculus.
Thus, we first represent our Hamiltonian $h\in\mathcal{A}^N$ from Eq.~\eqref{eq:nct_hamiltonian} as a finite $2N^d\times2N^d$ matrix $\hat{\pi}^\rtimes_{ \vec{\varphi}}(h)$, diagonalize it, and use the spectral theorem to construct the finite Fermi projection
\begin{equation}
P^{\vec{\varphi}}_F = \hat{\pi}^\rtimes_{ \vec{\varphi}}(p_F) = \sum_{i=1}^{2N^d} \chi_{(-\infty,E_F)}(\epsilon_i) \ket{\epsilon_i}\bra{\epsilon_i},
\label{eq:Fermi_projection}
\end{equation}
where $\epsilon_i$ and $\ket{\epsilon_i}$, $i=1,\dots,2N^d$, are the energy eigenvalues and eigenvectors of $\hat{\pi}^\rtimes_{ \vec{\varphi}}(h)$ in $\mathbb{C}^2\otimes\ell^2(V_N)$.
The approximate derivations of the Fermi projection can be computed from this representation as established in section \ref{subsec:approx_calculus} and the approximate Chern number we obtain numerically is then computed as
\begin{align}
    \hat{Ch}^{\vec{\varphi}}_J(p_F) = \frac{(2\pi i )^{ | J| /2 }}{(| J| /2)!}  \sum_{\sigma \in S_{|J|} } (-1)^\sigma \frac{1}{|V_N|} \sum_{\vec{m} \in V_N} \tr~ \bra{\vec{m}} \hat{\pi}^\rtimes_{\vec{\varphi}}(p_F) \prod_{j \in J} \hat{\pi}^\rtimes_{\vec{\varphi}}(\partial_{\sigma_j} p_F) \ket{\vec{m}}.
    \label{eq:approx_Chernnumber}
\end{align}
For readability, we will refer to the numerically evaluated Chern numbers of a specified gap in section \ref{sec:results} by $Ch_J$.

\subsection{Error bounds}
\label{subsec:error}
% -- error bounds
% Chapters 6 and 8(!) of 'A Computational Non-Commutative Geometry Program'
In \cite[Chap. 6, 8]{Prodan2017} error bounds are established for the smooth and non-smooth correlation functions evaluated with the finite-volume approximation.
These are valid for the finite-volume approximate algebra with its proper trace. Thus they are only applicable to the phase space average of our results. Nevertheless, we observe a matching convergence.

Let $h$ be the Hamiltonian from Eq.~\eqref{eq:nct_hamiltonian}, $E_F$ the Fermi energy located in the spectral gap of $h$, and $p_F$ the corresponding Fermi projection as given in Eq.~\eqref{eq:Riesz_projector}.
Then for any $K\in \mathbb{N}$, there exists a finite constant $C_K$ such that
\begin{equation}
    | Ch_J(p_F) - \frac{1}{(2\pi)^{r}} \int_{T^r}\dd \vec{\varphi} ~ \hat{Ch}^{\vec{\varphi}}_J(p_F) | \leq \frac{C_K}{(1+|V_N|)^K},
\end{equation}
where $J$ is any subset of indices $J\subseteq\{t_1, \ldots, t_d, u_1, \ldots, u_r\}$ of even cardinality.
Thus, the convergence to the thermodynamic limit of the finite-volume approximation with phase space average is faster than any inverse power of the finite supercell's size.

\section{Results}
\label{sec:results}

\subsection{Full topological classification of electronic states in the hexagonal SkX phase}

Topological features in the electronic structure are known to appear in the strong coupling limit $\| \xc /\hop\| \gg 1$ of two-dimensional skyrmionic crystals in the tight binding approximation~\cite{Hamamoto2015}.
This has been the motivation for our previous work~\cite{Lux2024}.
In this section, we want to complete our program for the hexagonal skyrmion crystal hosted by a triangular lattice as initiated in~\cite{Lux2024} and give a full list of all topological invariants that can be attributed to the observable gaps in the spectrum.

We first want to comment on which topological invariants can be expected to arise from very general arguments.
Based on the discussions of the previous sections, we can view $h$ in this case as an element of the noncommutative torus $C(T^2)\rtimes_\theta \mathbb{Z}^2$ tensored with the operators $M_2(\mathbb{C})$ that act on the internal spin degree of freedom and write
\begin{align}
    h / \xc = (1-2 p)+\epsilon \Delta ,
\end{align}
where we assume $\xc>0$, $\epsilon = \hop/ \xc$, and where $\Delta$ is the adjacency operator of the lattice (the operator which couples nearest neighbors with unit strength).
The operator $p$ depends on the magnetic texture $\hatn \in C^\infty(T^2, S^2)$ and is given by the projection
\begin{align}
    p = \frac{1}{2}\left(
    1 \otimes t^0  - \bsigma\cdot \hatn(\vec{\varphi}) \otimes t^0 )
    \right).
\end{align}
When $\epsilon=0$, the Hamiltonian $h$ has a gap at zero energy, referred to as the zero energy gap in the following. For $0<\| \epsilon \| \ll 1 $, this gap stays open, and the gap projection operator changes continuously as a function of $\epsilon$.
For a topological classification of the zero energy gap, we can thus focus on the limit of $\epsilon \to 0$.
The occupied subspace below zero energy belongs to the eigenspace of $p$ with an eigenvalue equal to one, characterized by a perfect anti-alignment of the electron spin with the vector field specified by $\hatn$. 
We compute the Chern numbers
\begin{align}
    n_{\emptyset}=C_\emptyset([p]_0 ) = 1,
\end{align}
and 
\begin{align}
   n_{\lbrace u_1, u_2 \rbrace }= C_{\lbrace u_1, u_2 \rbrace }([p]_0 ) &= -2\pi i \int\limits_{T^2} \frac{\dd \vec{\varphi}}{(2\pi)^2}~
     \tr ~(\bsigma\cdot \hatn) [(\bsigma\cdot \partial_{\varphi_1}\hatn),(\bsigma\cdot \partial_{\varphi_2}\hatn)] / 8
    \\
    &=
    \frac{1}{4 \pi} \int\limits_{T^2} \dd \vec{\varphi}~
    \hatn \cdot( \partial_{\varphi_1}\hatn \times \partial_{\varphi_2}\hatn)
    \\
    &= \mathrm{deg}~\hatn .
\end{align}
The remaining Chern numbers for this gap are zero since $p$ commutes with the position operator.
As the trivial projection $\vec{1}$ has the trace $2$ and exhibits $0$ for all other Chern numbers, we can also infer that the unoccupied subspace above zero energy, which is the eigenspace of
\begin{align}
    p^\perp=\vec{1}-p=\frac{1}{2}\left(1 \otimes t^0  + \bsigma\cdot \hatn(\vec{\varphi}) \otimes t^0 ) \right),
\end{align}
carries $n_{\emptyset}=1$, $n_{\lbrace u_1, u_2 \rbrace }=-\mathrm{deg}~\hatn$, and $0$ for the remaining Chern numbers.

Another interesting quantity to look at is the spin magnetization. It has the expectation value
\begin{align}
    \vec{S} = \mathcal{T}(\bsigma p ) = -\frac{1}{(2\pi)^2}
    \int\limits_{T^2} \dd \vec{\varphi}~ \hatn(\vec{\varphi}),
\end{align}
in units of $\hbar/2$. 
This reproduces Eq.~\eqref{eq:magnetization_formula} from section $\ref{subsec:our_model}$ and the spin magnetization will follow the phase diagram as shown in Fig.~\ref{fig:3QskxPD}.

% -- full Chern hierarchy of selected gaps, figure 3
When the length scale of the skyrmion crystal now approaches the lattice constant, further energy gaps open inside the two blocks of aligned and anti-aligned states over and under zero energy.
This can be observed by computing the spectrum of the tight-binding Hamiltonian for a range of $\vartheta$ values via exact diagonalization or more sophisticated algorithms such as the \emph{Kernel Polynomial Method} (KPM) \cite{Weiße2006} which makes it computationally viable to evaluate much larger supercells.
In Fig.~\ref{fig:Spectrum}, we used the KPM to evaluate the spectrum of the tight-binding Hamiltonian from Eq.~\eqref{eq:tbHamiltonian} with parameter $\hop=1$ and $\xc=5$ on a supercell of size $N_x=N_y=400$. The magnetic texture $\hatn \in C^\infty(T^2, S^2)$ is implemented as in Eq.~\eqref{eq:skx_texture} with phase shift and magnetization parameters $\varphi_1=\varphi_2=\varphi_3=0$ and $m=0$. 
For the KPM algorithm, we choose $2048$ energy values, $2048$ Chebyshev moments, and $10$ random states.
The length scale parameter $\vartheta$ takes values in a system of size $N=400$, i.e., $\vartheta=\frac{i}{400}$ with $i=1,\dots,199,201,\dots,399$.
\figureIII
\tableI

Let us now inspect the gaps in between the aligned states in the upper block $(U)$ and anti-aligned states in the lower block $(L)$. 
There are several gaps at finite $\vartheta$, which remain opened but narrow for $\vartheta\to0$.
We refer to those as being connected to the adiabatic limit.
The gaps between the lowest energy bands in each block are the widest, and some of them have been marked with dots and numbered from bottom to top for further examination.
Besides these gaps, some gaps open near $\vartheta=1/2$, which only remain open over a short interval of finite $\vartheta$.
Since those gaps are not connected to the adiabatic limit of smooth textures and are as such not treatable with commutative geometry, we coin them {\it noncommutative spectral gaps}.
%
To compute all Chern numbers corresponding to the gaps marked with dots, we use the periodic approximating algebra formalism introduced in section \ref{sec:computation}. 
We first perform an exact diagonalization of the tight-binding Hamiltonian as above on a supercell of size $N_x=N_y=57$ for $\vartheta=\frac{10}{57}$ (the corresponding texture is depicted in Fig.~\ref{fig:skx_texture_scaling} (a)) and from the eigenstates we construct Fermi projection operators according to Eq.~\eqref{eq:Fermi_projection} with Fermi energy $E_F$ inside the chosen gaps. 
They are representations of projections from the periodic approximate algebra of the noncommutative torus, and we can compute their derivations to evaluate the corresponding Chern numbers as detailed in Eq.~\eqref{eq:approx_Chernnumber}.
The partial derivatives $\partial_{\varphi_j}P^{\vec{\varphi}}_F$ are numerically implemented as a difference quotient with $\Delta\varphi_j=10^{-8}$.
The results are displayed in Table \ref{fig:Spectrum}~(b). 
From these Chern numbers, we can also immediately extract the $\vartheta$-independent coefficients of the Fermi projection with respect to the $K_0$ group generators by using equations \eqref{eq:Chernlabels1}-\eqref{eq:Chernlabels8}. This gives us a full set of integer labels for the gaps as displayed in Table \ref{fig:Spectrum}~(c).

It can be seen that the numerically computed coefficients are indeed quantized to integer values to good accuracy, and the Chern numbers and coefficients of the zero energy gap (Gap $0$ {\Large\textcolor[rgb]{0.301961,0.686275,0.290196}{\ensuremath\bullet}}) match our preliminary consideration $n_{\emptyset}=n_{\lbrace u_1, u_2 \rbrace }=1$ and $0$ for the remaining Chern coefficients.
The $\emptyset$ and ${\lbrace u_1, u_2 \rbrace }$ Chern labels of the marked gaps above zero energy $(U)$ are equal to $1$, while the marked gaps below zero energy $(L)$ exhibit $0$. 
This raises the question which electronic band is responsible for carrying this quantized Chern number.
Similarly, some bands above the highest of our marked gaps need to carry a Chern label contribution of $1$ to $n_{\emptyset}$ and $-1$ to $n_{\lbrace u_1, u_2 \rbrace }$ to be consistent with our assessment from general principles.
The ${\lbrace t_1, t_2 \rbrace }$ Chern label of the marked gaps above zero energy increases by $1$ per gap, which means that the energy bands in between carry a contribution of $1$ each.
Below zero energy, the sign is flipped. 
Since we know that the Chern label of the zero energy gap is $0$, the contributions of these energy bands need to be compensated by some bands in the same block. 
The same is true for the block above zero energy.
All remaining mixed space first Chern numbers are zero for all marked gaps.
Lastly, the ${\lbrace t_1, t_2, u_1, u_2 \rbrace }$ Chern labels of the marked gaps are similar to the ${\lbrace t_1, t_2 \rbrace }$ Chern labels, but have a negative sign below and above zero energy. 
Also, some compensating energy bands need to exist here.

\figureIV

% -- main Chern number over the full range of Fermi energies, figure 4
To investigate further which energy bands exactly contribute to the main Chern numbers, we compute them in dependence on the Fermi energy on a supercell of size $N=57$ for $\vartheta=10/57$ as well as $N=53$ for $\vartheta=20/53$, as shown in Fig.~\ref{fig:ChernHierarchy}. 
The density of states in the middle is computed with the KPM on a system of size $400$ and the same Hamiltonian parameters as before.
This way, we can determine which states carry the quantized ${\lbrace u_1, u_2 \rbrace }$ Chern coefficient contributions.
Starting at the bottom of the energy range, the first real space Chern number $Ch_{\lbrace u_1, u_2 \rbrace }=n_{\lbrace u_1, u_2 \rbrace }$ is consistently $0$, even outside of gaps, until we get close to $E\approx -3$, at which point it jumps to $1$ and stays again stable until $E\approx 7$, where it jumps back two $0$.
This implies, that a single band at these energies carries the entire block's contribution of $\pm \mathrm{deg}~\hatn$.
The two energies are correlated with an increased density of states. 
Indeed, the DOS shows a pronounced peak persisting in the limit of $\vartheta\to0$, consistent with the \emph{van Hove singularities} (VHS) of the triangular electronic lattice,  located at the respective energies $E_{VHS}\approx 2\hop+\xc=7$ and $E_{VHS}\approx 2\hop-\xc=-3$~\cite{Gobel2017}. 

Further, one can observe that the first momentum space Chern number $Ch_{\lbrace t_1, t_2 \rbrace }=n_{\lbrace t_1, t_2 \rbrace }$ of the upper, spin-aligned block of energy states, increases by $1$ with each gap connected to the adiabatic limit of $\vartheta\to 0$.
For $\vartheta=10/57$ at the present numerical accuracy, this is well discernible for this block's lowest $10$ gaps $U1,\dots,U10$.
This trend seems to reverse at higher energies, and around $E=7$ the overall Chern numbers become negative.
The Chern labels of the highest two gaps $U-2$ and $U-1$ are perceivable to be $-4$ and $-2$, respectively.
The gaps are less pronounced for the lower block of spin anti-aligned energy states, but the Chern numbers behave the same with a flipped sign and turning point around $E=-3$.
This is consistent with the known findings from mapping the bands to Landau levels which one finds to contribute $1$ to the Chern number when below and $2$ when above the VSH~\cite{Gobel2017}.

\figureV

For $\vartheta=20/53$, the gap formation is even less pronounced, and several gaps are not connected to the limit of smooth textures, $\vartheta\to 0$.
They seem to behave differently from the rules we observe for the connected gaps. 
While for $\vartheta=10/57$, the Chern numbers follow a rather predictable pattern from gap to gap, the same cannot be said for $\vartheta=20/53$, where no clear pattern can be identified.
A look at the real-space distribution of the spins in Fig.~\ref{fig:skx_texture_scaling} (b) reveals a texture that does not resemble a skyrmion lattice at first sight. 
Yet, the electrons' real-space winding number $Ch_{\lbrace u_1,u_2 \rbrace }$ still exhibits quantization. 
The skyrmionic nature of the texture can thus only reveal itself through (approximate) ergodicity.

In conclusion, we can deduce from the results of this subsection that the bands at the VHS carry the whole $\pm \mathrm{deg}~\hatn$ contribution to the first real space Chern number of the whole block, as well as the whole Chern number contribution to the first momentum space and the second mixed space Chern numbers to compensate for all the other bands' contributions of $\pm 1$ and $\pm2$.
Electrons at the VHS are characterized by a vanishing group velocity.
Their spin can thus align perfectly with texture $\hatn$.
Notably, those seem to be the only states with nontrivial spin winding.


\subsection{Topological phase transitions following a change of real-space winding}

In section \ref{sec:multi_q_magnets}, we demonstrated that the winding number $\mathrm{deg}~\hatn$ changes discontinuously when varying the texture parameters $\varphi$ and $m$ as displayed in Fig.~\ref{fig:3QskxPD}, reproducing the result from \cite{Shimizu2022}. Some example textures for different $\mathrm{deg}~\hatn$ are presented in Fig.~\ref{fig:skx_texture_phases}.
According to our preliminary consideration $Ch_{\lbrace u_1, u_2 \rbrace }=n_{\lbrace u_1, u_2 \rbrace }$ of the electronic spectrum must change in correspondence.
In this section, we want to inspect this case further and investigate how the electronic topology will respond to a change in the real-space topology. 
We first compute the main Chern numbers of the full Fermi energy range for two different areas of the texture's topological phase diagram and then we compute the change of the Chern numbers over a continuous path in parameter space.

\figureVI

In Fig.~\ref{fig:ChernHierarchyShift}, we begin with the case $\varphi=\varphi_1+\varphi_2+\varphi_3=\pi$ and $m=0$, for which we get $\mathrm{deg}~\hatn=-1$.  
This change in parameters compared to the previous section is equal to the time-reversal operation (up to translation) as it switches the overall sign of the entire spin texture. 
All other parameters are the same as for Fig.~\ref{fig:ChernHierarchy} and, thus, the density of states is also the same as in Fig.~\ref{fig:ChernHierarchy} for $\varphi=0$. This is expected as the time-reversal operation does not affect the energy eigenvalues. 
Accordingly, the second mixed space Chern number remains unaltered as well.

\figureVII
\figureVIII

This is expected for the same reason, since $Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace }=n_{\lbrace t_1, t_2, u_1, u_2 \rbrace }$ is the coefficient of the quadratic term of the integrated density of states in dependence of the length scale parameter, see Eq.~(\ref{eq:ids_constraint}).
On the other hand, both first Chern numbers switch their sign. 
This is not surprising in the case of $Ch_{\lbrace u_1, u_2 \rbrace }$, since it corresponds to $\mathrm{deg}~\hatn$ and therefore it is odd under the time reversal operation. 
The same holds true for  $Ch_{\lbrace t_1, t_2 \rbrace }$.

Next, we consider the case of $\varphi=\varphi_1+\varphi_2+\varphi_3=0$ and $m=0.7$, for which we get $\mathrm{deg}~\hatn=-2$, displayed in Fig.~\ref{fig:ChernHierarchyMag}. Here, the texture is not obtained from a global symmetry operation and the result is less predictable from general considerations.
At this point in parameter space, only the lowest gaps of each block are sufficiently clear, which gives us less energy range at which our Chern number calculations converge to integers. 
$Ch_{\lbrace u_1, u_2 \rbrace }$ is far less stable than before, but again starts at $0$ at the lower end of the energy range and jumps to $\mathrm{deg}~\hatn=-2$ after $E=-3$ until it goes back to $0$ after $E=7$. 
Thus, it still behaves analogously to the prior cases.
However, unexpectedly $Ch_{\lbrace t_1, t_2 \rbrace }$ is $0$ in the gaps $U1^{\prime}$, $U2^{\prime}$, and $U-1^{\prime}$ as well as in the gaps $L1^{\prime}$, $L2^{\prime}$, and $L-1^{\prime}$, while
$Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace }$ is $-1$ in $U1^{\prime}$, $-3$ in $U2^{\prime}$, and $2$ in $U-1^{\prime}$.
This implies that the first energy band of the block carries a contribution of $1$ to the mixed space Chern number, the second band however carries $2$, and the last band carries $2$ as well.
For the lower block, the $L1^{\prime}$ and $L-1^{\prime}$ gaps have the same second mixed space Chern numbers as in the upper block, but in the $L2^{\prime}$ gap this Chern number does not converge properly.

\figureIX

% -- scan across some line cuts
To understand what happens between these three points in parameter space which are characterized by different winding numbers of the magnetic texture, we focus next on the change of the spectrum and the change of the main Chern numbers in gap $U1$.
In Fig.~\ref{fig:DoSShifts} we compute the spectrum of the tight-binding Hamiltonian with the KPM in a supercell of size $400$ for $\vartheta=\frac{10}{57}$ and parameters as above for phase shifts $\varphi$ between $0$ and $\pi$ at $m=0$ and $m=0.7$, as well as for $m$ between $0$ and $1$ for $\varphi=0$.
The spectrum along the $m=0$ line in Fig.~\ref{fig:DoSShifts} (a) is symmetric and returns to its initial shape, as the end point is obtained by the time reversal of the starting point.
For $\varphi\to\frac{\pi}{2}$ at which point the winding number $\mathrm{deg}~\hatn$ jumps from $1$ to $-1$ all gaps in between the blocks of aligned and anti-aligned states close and reopen again.
The $\varphi=0$ line in Fig.~\ref{fig:DoSShifts} (b) starts at the same parameter point with $\mathrm{deg}~\hatn=1$.
At $m=\frac{1}{\sqrt{3}}$ the texture's winding number jumps to $\mathrm{deg}~\hatn=-2$ and at $m=\frac{\sqrt{3}}{2}$ to $\mathrm{deg}~\hatn=0$, however this is not apparent from the spectrum. The $U1$ gap closes at an earlier $m$ value and reopens afterwards to $U1^{\prime}$, and the $U2$ gap closes and stays closed.
This makes the $U2^{\prime}$ from Fig.~\ref{fig:ChernHierarchyMag} a factual  continuation of gap $U3$ from Fig.~\ref{fig:ChernHierarchy}, which explains that it carries the second Chern number $Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace }=-3$.
For $m\to1$ all gaps except $U1$ have closed.
The last line we follow in Fig.~\ref{fig:DoSShifts} (c) starts with the spectrum which is at $m=0.7$ in Fig.~\ref{fig:DoSShifts} (b), where the $U1^{\prime}$  and $U2^{\prime}$ gaps are wide open and clear in the upper block. At the start we have $\mathrm{deg}~\hatn=-2$ that jumps to $\mathrm{deg}~\hatn=-1$ around $\varphi=0.1\pi$. The $U1^{\prime}$  
gap closes briefly around $\varphi=0.4\pi$ and the second energy band splits to reopen the $U2$ gap we had before at $m=0$ and $\varphi=0$. Also multiple higher gaps open.
This is consistent with our expectations as the spectrum at the endpoint is in the same area of the winding number phase diagram from Fig.~\ref{fig:3QskxPD} as the spectrum at $m=0$ and $\varphi=\pi$.

\figureX
Next, we examine how the main Chern numbers of the first gap $U1$ or, respectively, $U1^{\prime}$, which is the gap that stays open for most of the parameter range, change along these paths through the parameter space.
For the top row of Fig.~\ref{fig:ChernShifts}, we computed the exact diagonalization of the tight-binding Hamiltonian on a supercell of size $57$ for $\vartheta=\frac{10}{57}$ and parameters as above and plotted the individual energy eigenvalues. From this diagonalization, we also computed the corresponding main Chern numbers.
Since we are particularly interested in their response to the discontinuities in the texture, we choose a phase space origin position $\vec{\varphi}$ to move the singularity onto the site at $\vec{x}_0$.
For the path along $m=0$ and $m=0.7$ we choose $[\pi+\arccos{\frac{m}{\sqrt{3}}}+\varphi,\pi+\arccos{\frac{m}{\sqrt{3}}},-2\arccos{\frac{m}{\sqrt{3}}}]$ and for $\varphi=0$ we choose $[\pi,\pi,0]$.

Along the $m=0$ line, depicted in Fig.~\ref{fig:ChernShifts}~(a), we have a sharp jump from $1$ to $-1$ in $Ch_{\lbrace u_1, u_2 \rbrace }$ at $\varphi=\pi$, where the winding number switches from $1$ to $-1$ as well.
$Ch_{\lbrace t_1, t_2 \rbrace }$ follows through, but the transition is less sharp and nearly continuous over a wider parameter range.
It coincides with two states crossing the first gap.
The second Chern number $Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace }=-1$ remains mostly constant but undergoes a peak in the vicinity of the winding number transition.
Similarly, following the $\varphi=0$ line in parameter space, shown in Fig.~\ref{fig:ChernShifts}~(b), $Ch_{\lbrace u_1, u_2 \rbrace }$ matches the winding number of the texture. The first jump from $1$ to $-2$ at $m=\frac{1}{\sqrt{3}}$ coincides with a singularity of $Ch_{\lbrace u_1, u_2 \rbrace }$, while the second transition from $-2$ to $0$ at $m=\frac{\sqrt{3}}{2}$ is continuous.
This is caused by the real space position of the lattice sites and whether the singularity of the magnetization vector field occurs close by one of them. If we would additionally average over the phase space, the Chern number would exhibit a singularity at both parameter points.
However, $Ch_{\lbrace t_1, t_2 \rbrace }$ does not follow suit with the winding number and changes at a lower value of $m$: already at $\approx0.27$ a band crossing in the first gap occurs and $Ch_{\lbrace t_1, t_2 \rbrace }$ changes nearly continuously from $1$ to $0$.
The second Chern number $Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace }=-1$ remains again mostly constant but undergoes a peak in the vicinity of the band crossing and a singularity at the point of the singularity of $Ch_{\lbrace u_1, u_2 \rbrace }$, however does not respond to the second continuous change of $Ch_{\lbrace u_1, u_2 \rbrace }$.
The behavior of the Chern numbers along the $m=0.7$ line in Fig.~\ref{fig:ChernShifts}~(c) holds more unexpected features.
While $Ch_{\lbrace u_1, u_2 \rbrace }$ exhibits a singularity around $\varphi=0.1\pi$ and jumps from $-2$ to $-1$ following the winding number, $Ch_{\lbrace t_1, t_2 \rbrace }$ changes continuously over a wide range around $\varphi=0.4\pi$ from $0$ to $-1$, while none of the eigenvalues in the system of size $57$ crosses the gap. 
However, for a change in Chern number to occur in a system there must be a gap closing \cite{Bellissard1995} in the spectrum, and indeed for a system size of $137$, we observe a crossing in the eigenvalues.
At this point we need to remark, that this is not purely dependent on the system size, but rather on the ergodicity condition. For some sizes the crossing does appear for others it does not. This could also be resolved by computing the phase space average.
Again for this path, the second Chern number $Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace }=-1$ remains mostly constant with a peak around the band crossing and singularity at the singularity position of $Ch_{\lbrace u_1, u_2 \rbrace }$.

% -- phase shifts phase diagram
Since the parameter position of the band crossing at which $Ch_{\lbrace t_1, t_2 \rbrace }$ changes does not coincide with the parameter position of the jumps in winding number, except for at $m=0$, we further scan over the whole relevant area of parameter space to identify its pattern. As displayed in Fig.~\ref{fig:ChernDiagram}, we compute the main Chern numbers for the tight-binding Hamiltonian on a system of size $57$ with parameters as above for $\varphi$ ranging from $0$ to $\pi$ and $m$ ranging from $-2$ to $2$ and a phase space origin set to $\vec{\varphi}=[\varphi,0,0]$.
\figureXI

Here, $Ch_{\lbrace u_1, u_2 \rbrace }$ perfectly reproduces the winding number phase diagram from Fig.~\ref{fig:3QskxPD}, which we already observed for the three paths.
On the border lines between the different areas, it exhibits singularities at regular distances. Those coincide with the points in parameter space for which a discontinuity in the magnetization texture lies in the immediate vicinity of a lattice site. Due to the different choices of $\vec{\varphi}$ these positions do not coincide with the singularities observed along the paths above. Computing the average over the phase space would cause singularities along the whole border.
Interestingly, the sharp change in $Ch_{\lbrace t_1, t_2 \rbrace }$ at which band crossings occur coincides with the parameter line in which the net magnetization $\braket{\hat{n}_z}$ is zero.
Precisely at those positions, the system is time-reversal invariant (modulo lattice symmetry), and thus $Ch_{\lbrace t_1, t_2 \rbrace }$ is forced to vanish by reasons of symmetry. 
The borders of the areas with $Ch_{\lbrace t_1, t_2 \rbrace }=\pm1$ for $|m|\to 2$ resemble the areas of $Ch_{\lbrace u_1, u_2 \rbrace }$ but are more fuzzy which might be a finite system size effect.
As for the paths before, the second Chern number $Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace }=-1$ remains mostly constant. At the transition borders of the other Chern numbers it is affected by peaks or singularities but does not change, except for the outside border for $|m|\to 2$ for which it transitions to $0$.

\subsection{On the existence of topological spectral flow}
While all transitions of $Ch_{\lbrace t_1, t_2 \rbrace }$ are accompanied by a band crossing, we do not observe band crossings that correspond to the change in $Ch_{\lbrace u_1, u_2 \rbrace }$, especially no closing of the zero energy gap. This is due to the singular nature of the transition as discussed in section \ref{subsec:real_space_classification}. To make the transition continuous, we regularize the singularity with a parameter $\eta=0.1$ as described in Eq.~\eqref{eq:regularize}. This leads to a shift in energy close to the transition, a shift of the critical parameter point ($\varphi_c$,$m_c$) at which the transition occurs, and a crossing of energy eigenstates.
We compute the spectrum of the tight-binding Hamiltonian with regularized magnetic texture analogous to Fig.~\ref{fig:DoSShifts} with the KPM on a system of size $400$ as displayed in Fig.~\ref{fig:DoSShiftsReg}.

Indeed, along the $m=0$ path in Fig.~\ref{fig:DoSShiftsReg} (a) we clearly see the band crossing at $\varphi=\pi$. The bands of the upper block bend downwards and the bands of the lower block bend upwards. At the top of the lower block, a single band bends upwards until it touches the bottom band of the upper block, crossing the zero energy gap.
Similarly, in Fig.~\ref{fig:DoSShiftsReg} (b) we also see band crossings along $\varphi=0$ at the parameter positions of the winding number jumps, however with a lower density of states. Since the phase space origin $\vec{\varphi}$ of the texture for this computation was chosen in a way, that the first former singularity would be sitting right on the lattice site with label $\vec{0}$, the first band crossing fully closes the gap while the second crossing leaves a small gap open.
In Fig.~\ref{fig:DoSShiftsReg} (c), we choose $\vec{\varphi}$ to position the former singularity on the origin lattice site as well. Also here, we can see how states from the lower block bend upwards and cross the gap around $0.1\pi$ where the winding number transition takes place.
\figureXII
\figureXIII

Finally, we need to examine the effect of the regularization on the Chern number transitions, which we do in Fig.~\ref{fig:ChernShiftsReg} computed analogously to Fig.~\ref{fig:ChernShifts}, but with the regularization procedure applied. We can observe the behavior of the individual energy eigenstates from the tight-binding Hamiltonian for system size $57$ and the corresponding main Chern numbers.
Along $m=0$ in Fig.~\ref{fig:ChernShiftsReg}~(a), we see how a high number of states is bent upwards such that several states close the gap. The transition of the Chern numbers is nearly identical to that in Fig.~\ref{fig:ChernShifts}~(a), except for $Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace }$ which exhibits a broader peak than before.
In Fig.~\ref{fig:ChernShiftsReg}~(b), we see a single energy state close the gaps for the first transition, due to the choice of the phase space origin, and a few states bend only halfway upwards to close the gaps for the second transition. The Chern numbers behave very similarly to those in Fig.~\ref{fig:ChernShiftsReg}~(b), except for the position of the $Ch_{\lbrace t_1, t_2 \rbrace }$ transition which happens at around $m\approx0.375$ in comparison to $m\approx0.275$ for the texture which was not regularized. The regularization predominantly impacts the magnetization and therefore also the parameter position for which $\braket{\hat{n}_z}$ goes to zero.
$Ch_{\lbrace t_1, t_2, u_1, u_2 \rbrace }$ exhibits a new dip at the second transition.
In Fig.~\ref{fig:ChernShiftsReg}~(c), we also only have a single energy state which nearly closes the gap at the position where formerly the singularity occurred. The position of the $Ch_{\lbrace t_1, t_2 \rbrace }$ transition is shifted from around $\varphi=0.4\pi$ to around $\varphi=0.27\pi$, which is also due to the change in magnetization.

% -- exiting the algebra
The reason why the spectral flow \cite{Doll2023} over the phase transition does or does not appear in real space can be found in algebraic arguments.
Namely, the observable algebra $M_2(\mathbb{C})\otimes(C(T^2)\rtimes_{\theta} \mathbb{Z}^2)$ itself requires the continuity of the magnetic texture as a function of the phase space $T^2$, which also implies continuity on the real space $\mathbb{R}^2$.
However, it is impossible to keep the texture normalized to a field of unit vectors $\hatn(\vec{x})=\vec{n}(\vec{x})/||\vec{n}(\vec{x})||$ and maintain continuity across the transition.
There must exist a critical point along the reaction path at which the texture exhibits a discontinuous singularity somewhere in real space.
With this point, we no longer have a continuous path of Hamilton operators, which at each point are given by the covariant representation of an element from the observable algebra.
Therefore, the Fermi projections before and after the critical point are no longer homotopic within the space of projections from the observable algebra, even without closing the spectral gap, and the gap labels no longer need to be preserved.

This point of zero measure will stay unnoticed by a generic computation, as it will almost surely fall somewhere in between the lattice sites and thus go unnoticed.
And if it were to fall on a lattice site, the program would crash due to the undefined behavior.
Once the texture singularity is regularized, the texture can remain continuous along the reaction path, and the $K$-theory of the observable algebra enforces the existence of the spectral flow: the continuous path of the Fermi projections must be interrupted by a gap closure to allow the gap labels to be changed.

\section{Discussion}
\label{sec:conclusion}

% achieved an exhaustive classification
In this work, we provide a $C^\ast$-algebraic view on the interaction of real- and reciprocal space topology in skyrmion crystals.
As first shown in \cite{Lux2024}, and elaborated here, the electronic observables of multi-$q$ textures form a $C^\ast$-algebra $\mathcal{A}_\theta$, known as the noncommutative torus. 
For the case of a skyrmionic $3\vec{q}$-state hosted by a two-dimensional triangular lattice~\cite{Gobel2017, Gobel2017b}, we have determined the precise equivalence class of projections in $K_0(\mathcal{A}_\theta)=\mathbb{Z}^8$ for the main series of spectral gaps. 
To a good accuracy, a numerical computation of noncommutative Chern numbers for a given spectral gap indeed produces a series of eight integers, identifying the respective class in $K_0(\mathcal{A}_\theta)$:
the first main result of this work.

% van Hove singularity
By observing the dependence of Chern numbers as a function of the Fermi energy, one observation stands  out:
the Chern number describing the real-space winding of the electronic spin is carried by electrons at the van Hove singularity.
They are characterized by a vanishing group velocity likely facilitating the perfect alignment of the electronic spin with the imposed magnetic texture. 
Most bands producing a quantized anomalous Hall response have a trivial real-space winding number.
This observation might challenge some possible preconceptions about the physical origin of the Hall response.

% Hall response and real-space winding
Inspired by the work \cite{Shimizu2022}, we set out to study the evolution of electronic states across various topological phase transitions of the magnetic texture.
A first idea of the physics of noncollinear textures is typically obtained through the language of emergent electromagnetism.
Our results indicate that this picture can only serve as a first guess into the adiabatic behavior, but cannot account for the true complexity of the electronic spectrum away from the limit of strong coupling and smooth textures.
We could not identify a simple rule that ties the quantized Hall response to the electrons' real-space winding.
A change in a bands' quantized anomalous Hall response also occurs away from the real-space transitions and generally coincides with a spectral flow between the neighboring, participating bands.
% absence of spectral flow
Whether or not spectral flow occurs in the electronic system as one passes through the real-space transitions depends not only on the topological labels but also on the nature of the critical point itself. 
Since it is impossible to maintain continuity of the texture in passing from one topological configuration to another without sacrificing spin normalization, this leaves the door open for a brief exit out of the observable algebra at which the change of the electronic topology can occur unbeknownst to the observer. 
A real-world possibility is that the texture is not truly ergodic. 
In this case, a Bloch point singularity in the magnetic textures can occur in between lattice sites, and no spectral flow would be visible in the experiment. 
Ultimately, this question could be treated experimentally in the future: 
whether or not spectral flow is visible will hinge on the details of the magnetic configurations close to the phase transition.

% outlook: dynamics, magnetic fields, antiferromagnetic textures
Since the formalism naturally incorporates the possibility of applied magnetic fields and multi-$q$ textures are often stabilized with the help of such external fields, we see this as a natural next step for our investigation into the relation between noncommutative geometry and noncollinear magnetism.
Recently, antiferromagnetic multi-$\vec{q}$ textures have been proposed as another route toward realizing topological electronic states via complex magnetic order. 
Fundamentally, no change in the observable algebra is needed. 
It is still described by the same noncommutative torus and we therefore see this as another fruitful application for our formalism.
Lastly, the dynamical aspect should not be overlooked as spin and charge currents adiabatically induced by time-dependent magnetism have close connections to the underlying electronic topology \cite{Yang2011}.
Overall, we believe that our work showcases the usefulness of $C^\ast$ dynamical systems such as the noncommutative torus in the description of magnetic multi-$q$ order, where they can assist in disentangling the complex electronic structure and the associated topological features.

{\itshape Acknowledgements. } We thank Juba Bouaziz, Gregor Michalicek, and Tom Stoiber for fruitful discussions. Funding was received under the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) -- TRR
173/2 -- 268565370 (project A11), and TRR 288 -- 422213477
(project B06).
We acknowledge funding under SPP 2137 ``Skyrmionics". This work was further supported by the Max Planck Graduate Center with the Johannes Gutenberg-Universit\"at Mainz (MPGC). We also gratefully acknowledge the
J\"ulich Supercomputing Centre and RWTH Aachen University
for providing computational resources under projects jiff40
and jara0062.
E.P acknowledges support from the U.S. National Science Foundation through the grants DMR-1823800 and CMMI-2131760 and from the U.S. Army Research Office through contract W911NF-23-1-0127.

\bibliography{literature.bib}

\nolinenumbers

\end{document}
